(this["webpackJsonpuniversal-data-tool"]=this["webpackJsonpuniversal-data-tool"]||[]).push([[0],{206:function(e){e.exports=JSON.parse('{"name":"universal-data-tool","version":"0.8.4","license":"MIT","main":"desktop/main.js","homepage":"https://universaldatatool.com","scripts":{"postinstall":"electron-builder install-app-deps","start":"cross-env PORT=6001 react-scripts start","build":"npm run build:babel && npm run build:desktop","build:babel":"cross-env NODE_ENV=production babel ./src --out-dir=./lib && cp ./package.json ./lib/package.json","build:web":"CI=false react-scripts build","build:desktop":"cross-env CI=false REACT_APP_DESKTOP=true PUBLIC_URL=./ react-scripts build && electron-builder build && cp ./desktop/entitlements.mac.plist ./build/entitlements.mac.plist","start:desktop:dev":"USE_DEV_SERVER=yes electron ./desktop","start:desktop":"electron ./desktop","release:lib":"npm run build && cd lib && npm publish","release:desktop":"npm run build:desktop && cross-env EP_RELEASE=true electron-builder --linux --publish always","release":"npm run release:desktop","test":"react-scripts test","storybook":"start-storybook -p 6002 -s public","build-storybook":"build-storybook -s public","gh-pages":"npm run build:web && cp ./CNAME ./build/CNAME && gh-pages -d build","prettier":"prettier --write \\"src/**/*.js\\"","prettier:test":"prettier --check \\"src/**/*.js\\""},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"devDependencies":{"@babel/cli":"^7.5.0","@babel/core":"^7.5.4","@material-ui/core":"^4.9.5","@material-ui/icons":"^4.9.1","@storybook/addon-actions":"^5.3.14","@storybook/addon-links":"^5.3.14","@storybook/addons":"^5.3.14","@storybook/react":"^5.3.14","chroma-js":"^2.0.4","cross-env":"^7.0.0","electron":"^8.0.0","electron-builder":"^22.3.2","electron-builder-notarize":"^1.1.2","gh-pages":"^2.1.1","material-survey":"^1.0.32","react":"^16.8.6","react-dom":"^16.8.6","react-markdown":"^4.1.0","react-nlp-annotate":"^0.1.22","spelling":"^2.0.1"},"dependencies":{"@material-ui/styles":"^4.9.0","@semantic-release/git":"^9.0.0","@sentry/browser":"^5.15.4","any-shell-escape":"^0.1.1","bent":"^7.1.0","brace":"^0.11.1","detect-browser":"^5.0.0","download-file":"^0.1.5","duration":"^0.2.2","fast-json-patch":"^3.0.0-1","ffmpeg-static":"^4.0.1","in-browser-download":"^2.0.0","jac-format":"^1.1.2","js-md5":"^0.7.3","moment":"^2.24.0","posthog-js":"^1.0.4","prettier":"^2.0.2","react-ace":"^7.0.4","react-data-table-component":"^6.2.2","react-dropzone":"^10.1.8","react-icons":"^3.9.0","react-image-annotate":"^0.2.4","react-scripts":"^3.4.1","react-select":"^3.0.8","rfc6902":"^3.0.4","seamless-immutable":"^7.1.4","seed-random":"^2.2.0","seedrandom":"^3.0.5","styled-components":"^5.0.0","use-event-callback":"^0.1.0","ytdl-core":"^2.0.1"},"build":{"appId":"com.universaldatatool","productName":"Universal Data Tool","afterSign":"electron-builder-notarize","mac":{"category":"public.app-category.developer-tools","hardenedRuntime":true},"dmg":{"icon":false},"linux":{"target":["AppImage"],"category":"Development"},"extends":null,"files":["**/*","build/"],"publish":{"provider":"github","releaseType":"release"}}}')},452:function(e,t,a){e.exports=a(753)},457:function(e,t,a){},753:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(27),i=a.n(r),l=a(803),c=a(374),s=a.n(c),u=a(805),m=(a(457),a(124)),p=Object(l.a)({container:{fontFamily:'"Inter", sans-serif'}}),d=s()({palette:{primary:m.a,secondary:m.a},typography:{fontFamily:'"Inter", "Roboto", sans-serif',button:{textTransform:"none"}}}),f=function(e){var t=e.children,a=p();return o.a.createElement(u.a,{theme:d},o.a.createElement("div",{className:a.container},t))},g=a(24),b=a(18),v=a.n(b),h=a(29),O=a(8),x=a(817),E=a(50),k=a(812),j=a(813),y=a(835),w=a(814),C=a(207),S=a.n(C),I=a(378),D=a.n(I),T=a(208),N=a.n(T),A=a(267),L=a.n(A),R=a(837),B=a(433),P=a(375),_=a.n(P),U=a(88),F=a.n(U),z=a(430),M=a(119),W=a(122),H=a(303),V=a(367),q=a(811),J=a(195),G=a.n(J),K=a(117),Y=a.n(K),Q=a(304),X=a(138),Z=a.n(X),$=function(){return window.require?window.require("electron"):null};window.posthogInitialized=!1;var ee=function(){var e=Boolean($());if(!window.posthogInitialized){Z.a.init("dSrx1PbFd02XsxlLd7qNbeTxKZwwao2sclVmapyYlT4",{api_host:"https://posthog.universaldatatool.com",autocapture:!1});var t=e?"desktop":window.location.origin;Z.a.capture("domain",{domain:t}),Z.a.capture("is_desktop",{isDesktop:e}),Z.a.people.set({is_desktop:e,domain:t}),window.posthogInitialized=!0}return Z.a},te=Object(z.a)("div")({position:"relative",marginLeft:8}),ae=M.a[500],ne={bottom:"100%",left:"25%",border:"solid transparent",content:'" "',height:0,width:0,position:"absolute",pointerEvents:"none"},oe=Object(z.a)("div")({position:"absolute",zIndex:10,top:45,padding:16,boxSizing:"border-box",borderRadius:4,left:-53,backgroundColor:"#fff",border:"1px solid ".concat(ae),width:300,minHeight:200,boxShadow:"0px 3px 12px rgba(0,0,0,0.3)","&:before":Object(g.a)({},ne,{borderColor:"rgba(0,0,0, 0)",borderBottomColor:ae,borderWidth:12,marginLeft:-12}),"&:after":Object(g.a)({},ne,{borderColor:"rgba(255,255,255, 0)",borderBottomColor:"#fff",borderWidth:10,marginLeft:-10}),"& h1":{fontSize:18,marginTop:0,color:m.a[800]},"& h2":{fontSize:14,color:M.a[800]},opacity:1,transition:"opacity 200ms linear, transform 200ms ease","&.hidden":{opacity:0,transform:"translate(0, 10px)",pointerEvents:"none"}}),re=Object(z.a)(H.a)({marginTop:16,justifyContent:"flex-start",color:m.a[500],"& .icon":{marginRight:8,opacity:.7}}),ie=Object(z.a)(H.a)({marginTop:16,justifyContent:"flex-start","& .icon":{marginRight:8,opacity:.7,color:W.a[500]}}),le=function(e){var t=e.fileOpen,a=void 0!==t&&t,r=e.inSession,i=void 0!==r&&r,l=e.onJoinSession,c=e.onCreateSession,s=e.onLeaveSession,u=e.sessionBoxOpen,p=e.changeSessionBoxOpen,d=Object(n.useState)(!1),f=Object(O.a)(d,2),g=f[0],b=f[1],v=Object(n.useState)(""),h=Object(O.a)(v,2),x=h[0],E=h[1],k=Object(R.a)("userName","anonymous"),j=Object(O.a)(k,2),y=j[0],w=j[1],C=ee();return Object(n.useEffect)((function(){g&&setTimeout((function(){b(!1)}),1e4)}),[g]),o.a.createElement(te,{onMouseEnter:function(){return p(!0)},onMouseLeave:function(){return p(!1)}},o.a.createElement(B.a,{style:{color:i?m.a[500]:void 0}},o.a.createElement(_.a,null)),o.a.createElement(oe,{className:u?"":"hidden"},o.a.createElement("h1",null,"Collaborate"),i?o.a.createElement(o.a.Fragment,null,o.a.createElement(V.a,{style:{marginTop:12},variant:"outlined",label:"User Name",value:y,onChange:function(e){return w(e.target.value)}}),o.a.createElement(ie,{fullWidth:!0,onClick:s},o.a.createElement(Y.a,{className:"icon"}),"Leave Session")):o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",null,"Join a Session"),o.a.createElement(V.a,{variant:"outlined",label:"URL to Session",value:x,onChange:function(e){return E(e.target.value)},InputProps:{endAdornment:o.a.createElement(q.a,{position:"end"},o.a.createElement(B.a,{color:"primary",onClick:function(){C.capture("join_collaborative_session"),l(x)},disabled:!x},o.a.createElement(F.a,null)))}}),o.a.createElement(re,{fullWidth:!0,onClick:function(){C.capture("create_collaborative_session"),c(),b(!0)},disabled:!a||g},g?o.a.createElement(Q.a,{className:"icon",size:24}):o.a.createElement(G.a,{className:"icon"}),"Create New Session"))))},ce=a(205),se=a.n(ce),ue=a(125),me=M.a[500],pe={bottom:"100%",left:"25%",border:"solid transparent",content:'" "',height:0,width:0,position:"absolute",pointerEvents:"none"},de=Object(z.a)("div")({position:"absolute",zIndex:10,top:45,padding:16,boxSizing:"border-box",borderRadius:4,left:-53,backgroundColor:"#fff",border:"1px solid ".concat(me),width:300,minHeight:200,boxShadow:"0px 3px 12px rgba(0,0,0,0.3)","&:before":Object(g.a)({},pe,{borderColor:"rgba(0,0,0, 0)",borderBottomColor:me,borderWidth:12,marginLeft:-12}),"&:after":Object(g.a)({},pe,{borderColor:"rgba(255,255,255, 0)",borderBottomColor:"#fff",borderWidth:10,marginLeft:-10}),"& h1":{fontSize:18,marginTop:0,color:m.a[800]},"& h2":{fontSize:14,color:M.a[800]},opacity:1,transition:"opacity 200ms linear, transform 200ms ease","&.hidden":{opacity:0,transform:"translate(0, 10px)",pointerEvents:"none"}}),fe=function(e){var t=e.open,a=e.children;return o.a.createElement(de,{className:t?"":"hidden"},a)},ge=Object(z.a)("div")({position:"relative"}),be=Object(z.a)(H.a)({justifyContent:"flex-start","& .fakeicon":{display:"inline",marginRight:8,padding:4,paddingTop:5,fontSize:11,fontWeight:"bold",color:"#fff",backgroundColor:M.a[700],borderRadius:4,width:36,"&.blue":{backgroundColor:m.a[700]},"&.green":{backgroundColor:ue.a[700]}}}),ve=function(e){var t=e.onDownload,a=Object(n.useState)(!1),r=Object(O.a)(a,2),i=r[0],l=r[1];return o.a.createElement(ge,{onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)}},o.a.createElement(B.a,null,o.a.createElement(se.a,null)),o.a.createElement(fe,{open:i},o.a.createElement("h1",null,"Download"),o.a.createElement(be,{fullWidth:!0,onClick:function(){return t("csv")}},o.a.createElement("div",{className:"fakeicon green"},"CSV"),"Download CSV"),o.a.createElement(be,{fullWidth:!0,onClick:function(){return t("json")}},o.a.createElement("div",{className:"fakeicon blue"},"JSON"),"Download JSON")))},he=a(203);var Oe=function(e){return o.a.createElement(he.a,e,o.a.createElement("path",{d:"M12.007 0C6.12 0 1.1 4.27.157 10.08c-.944 5.813 2.468 11.45 8.054 13.312.19.064.397.033.555-.084.16-.117.25-.304.244-.5v-2.042c-3.33.735-4.037-1.56-4.037-1.56-.22-.726-.694-1.35-1.334-1.756-1.096-.75.074-.735.074-.735.773.103 1.454.557 1.846 1.23.694 1.21 2.23 1.638 3.45.96.056-.61.327-1.178.766-1.605-2.67-.3-5.462-1.335-5.462-6.002-.02-1.193.42-2.35 1.23-3.226-.327-1.015-.27-2.116.166-3.09 0 0 1.006-.33 3.3 1.23 1.966-.538 4.04-.538 6.003 0 2.295-1.5 3.3-1.23 3.3-1.23.445 1.006.49 2.144.12 3.18.81.877 1.25 2.033 1.23 3.226 0 4.607-2.805 5.627-5.476 5.927.578.583.88 1.386.825 2.206v3.29c-.005.2.092.393.26.507.164.115.377.14.565.063 5.568-1.88 8.956-7.514 8.007-13.313C22.892 4.267 17.884.007 12.008 0z"}))},xe=a(206),Ee=a(377),ke=a.n(Ee),je=a(307),ye=a(308),we=a(121),Ce=a(309),Se=a(123),Ie=a(120),De=a(20),Te=a(266),Ne=a.n(Te),Ae=a(376),Le=a.n(Ae),Re=a(21),Be={600:M.a[400],500:M.a[300],400:M.a[200],300:M.a[100],isFaded:!0},Pe=[m.a,je.a,ue.a,ye.a,we.a,Ce.a,Se.a,Ie.a],_e=Object(g.a)({},Re,{complete:m.a,incomplete:Be,faded:Be,review:je.a}),Ue=function(e){return _e[e]||Pe[Le()(e)*Pe.length]},Fe=Object(z.a)("div")({position:"relative"}),ze=Object(z.a)("div")((function(e){return{display:"inline",marginRight:8,backgroundColor:e.color[700],width:24,height:24,borderRadius:20}})),Me=Object(z.a)("div")({paddingTop:10,padding:4,display:"flex",flexWrap:"wrap"}),We=Object(z.a)(B.a)((function(e){var t=e.iconColor,a=e.selected;return{display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:t[700],border:a?"4px solid ".concat(t.A200):"4px solid #fff",boxSizing:"content-box",margin:4,transition:"transform 200ms linear","&:hover":{backgroundColor:t[800],transform:"scale(1.2,1.2)"},"&:active":{transition:"transform 100ms linear",transform:"scale(1.4,1.4)"}}})),He=Object(z.a)(H.a)((function(e){var t=e.selected,a=e.iconColor;return{justifyContent:"flex-start",marginTop:4,marginBottom:4,paddingTop:8,paddingBottom:8,backgroundColor:t?a[50]:"#fff",border:t?"2px solid ".concat(a[200]):"2px solid #fff","&:hover":{backgroundColor:t?a[100]:"none"}}})),Ve=function(e){var t=e.selectedBrush,a=e.onChangeSelectedBrush,r=Object(n.useState)(!1),i=Object(O.a)(r,2),l=i[0],c=i[1],s=Object(De.a)((function(e){return Ne()((function(){return a(e)}))}));return o.a.createElement(Fe,{onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)}},o.a.createElement(B.a,null,o.a.createElement(ke.a,{style:{color:Ue(t)[800]}})),o.a.createElement(fe,{open:l},o.a.createElement("h1",null,"Sample Brushes"),o.a.createElement(He,{selected:"complete"===t||"blue"===t,iconColor:m.a,fullWidth:!0,onClick:s("complete")},o.a.createElement(ze,{color:m.a}),"Complete"),o.a.createElement(He,{selected:"review"===t||"deepOrange"===t,iconColor:je.a,fullWidth:!0,onClick:s("review")},o.a.createElement(ze,{color:je.a}),"Review"),o.a.createElement(Me,null,o.a.createElement(We,{onClick:s("green"),selected:"green"===t,iconColor:ue.a}),o.a.createElement(We,{onClick:s("purple"),selected:"purple"===t,iconColor:ye.a}),o.a.createElement(We,{onClick:s("pink"),selected:"pink"===t,iconColor:we.a}),o.a.createElement(We,{onClick:s("cyan"),selected:"cyan"===t,iconColor:Ce.a}),o.a.createElement(We,{onClick:s("orange"),selected:"orange"===t,iconColor:Se.a}),o.a.createElement(We,{onClick:s("indigo"),selected:"indigo"===t,iconColor:Ie.a}))))},qe=Object(l.a)((function(e){return{headerButton:{marginLeft:16,color:"#888"},grow:{flexGrow:1},list:{width:300},tab:{color:"#000","& .icon":{}},fullHeightTab:Object(g.a)({},e.mixins.toolbar,Object(E.a)({},e.breakpoints.down("sm"),{minWidth:20})),tabWrapper:{display:"flex",flexDirection:"row",alignItems:"center",textTransform:"none",color:"#000","&&& svg":{marginBottom:0,marginRight:8,width:18,height:18}}}})),Je=function(e){switch(e){case"Settings":return o.a.createElement(S.a,{className:"icon"});case"Label":return o.a.createElement(N.a,{className:"icon"});case"Samples":return o.a.createElement(D.a,{className:"icon"})}},Ge=Object(n.memo)((function(e){var t=e.tabs,a=e.currentTab,n=e.onChangeTab,r=e.additionalButtons,i=e.onOpenDrawer,l=e.title,c=void 0===l?"Universal Data Tool":l,s=e.isDesktop,u=e.fileOpen,m=e.sessionBoxOpen,p=e.changeSessionBoxOpen,d=e.inSession,f=e.onCreateSession,g=e.onLeaveSession,b=e.onJoinSession,v=e.onDownload,h=e.selectedBrush,O=e.onChangeSelectedBrush,x=e.isSmall,E=qe();return o.a.createElement(k.a,{color:"white",position:"static"},o.a.createElement(j.a,{variant:"dense"},!s&&o.a.createElement(B.a,{onClick:i,className:E.headerButton},o.a.createElement(L.a,null)),u?c:"Universal Data Tool v"+xe.version,!s&&o.a.createElement(le,{sessionBoxOpen:m,changeSessionBoxOpen:p,fileOpen:u,inSession:d,onCreateSession:f,onLeaveSession:g,onJoinSession:b}),u&&o.a.createElement(Ve,{selectedBrush:h,onChangeSelectedBrush:O}),!s&&u&&o.a.createElement(ve,{onDownload:v}),o.a.createElement("div",{className:E.grow}),r,t.length>0&&o.a.createElement(y.a,{onChange:function(e,t){return n(t.toLowerCase())},value:a},t.map((function(e){return o.a.createElement(w.a,{key:e,classes:{root:E.fullHeightTab,wrapper:E.tabWrapper},className:E.tab,icon:Je(e),label:x?"":e,value:e.toLowerCase()})}))),!x&&o.a.createElement(B.a,{href:"https://github.com/openhumanannotation/universal-data-tool",className:E.headerButton},o.a.createElement(Oe,null))))})),Ke=a(838),Ye=a(133),Qe=a(810),Xe=a(758),Ze=a(313),$e=a(815),et=a(816),tt=a(386),at=a(384),nt=a.n(at),ot=(a(1),a(168)),rt=a(381),it=a.n(rt),lt=a(209),ct=a.n(lt),st=a(380),ut=a.n(st),mt=a(210),pt=a.n(mt),dt=a(99),ft=a.n(dt),gt=a(211),bt=a.n(gt),vt=a(383),ht=a.n(vt),Ot=a(212),xt=a.n(Ot),Et=a(98),kt=a.n(Et),jt=a(382),yt=a.n(jt),wt=[{name:"Empty",Icon:ut.a,oha:{interface:{},taskData:[]}},{name:"Image Segmentation",Icon:it.a,oha:{interface:{type:"image_segmentation",availableLabels:["valid","invalid"],regionTypesAllowed:["bounding-box","polygon","point"]},taskData:[{imageUrl:"https://s3.amazonaws.com/asset.workaround.online/example-jobs/sticky-notes/image1.jpg"},{imageUrl:"https://s3.amazonaws.com/asset.workaround.online/example-jobs/sticky-notes/image2.jpg"}]}},{name:"Image Classification",Icon:ct.a,oha:{interface:{type:"image_classification",availableLabels:["valid","invalid"]},taskData:[{imageUrl:"https://s3.amazonaws.com/asset.workaround.online/example-jobs/sticky-notes/image1.jpg"},{imageUrl:"https://s3.amazonaws.com/asset.workaround.online/example-jobs/sticky-notes/image2.jpg"}]}},{name:"Video Segmentation",Icon:kt.a,oha:{interface:{type:"video_segmentation",availableLabels:["valid","invalid"],regionTypesAllowed:["bounding-box","polygon","point"]},taskData:[{videoUrl:"https://s3.amazonaws.com/asset.workaround.online/SampleVideo_1280x720_1mb.mp4"}]}},{name:"Data Entry",Icon:ft.a,oha:{interface:{type:"data_entry",description:"# Markdown description here",surveyjs:{questions:[{type:"text",name:"document_title",title:"Title of Document"}]}},taskData:[{pdfUrl:"https://arxiv.org/pdf/1906.01969.pdf"},{pdfUrl:"https://arxiv.org/pdf/1908.07069.pdf"}]}},{name:"Named Entity Recognition",Icon:pt.a,oha:{interface:{type:"text_entity_recognition",overlapAllowed:!1,labels:[{id:"food",displayName:"Food",description:"Edible item."},{id:"hat",displayName:"Hat",description:"Something worn on the head."}]},taskData:[{document:"This strainer makes a great hat, I'll wear it while I serve spaghetti!"},{document:"Why are all these dumpings covered in butter?!"}]}},{name:"Text Classification",Icon:yt.a,oha:{interface:{type:"text_classification",labels:["positive_sentiment","negative_sentiment"]},taskData:[{document:"Wow this is terrible. I hated it."},{document:"This has made me so happy. I love this."},{document:"At first I wasn't sure. Then I thought, oh it's not very good."}]}},{name:"Audio Transcription",Icon:bt.a,oha:{interface:{type:"audio_transcription",description:"# Markdown description here"},taskData:[{audioUrl:"https://html5tutorial.info/media/vincent.mp3"}]}},{name:"Composite",Icon:ht.a,oha:{description:"# Markdown description here",interface:{type:"composite",fields:[{fieldName:"textInfo",interface:{type:"data_entry",surveyjs:{questions:[{type:"text",name:"group_letter",title:"Letter of Group"}]}}},{fieldName:"segmentation",interface:{type:"image_segmentation",availableLabels:["group text"],regionTypesAllowed:["bounding-box"]}}]},taskData:[{imageUrl:"https://s3.amazonaws.com/asset.workaround.online/example-jobs/sticky-notes/image1.jpg"},{imageUrl:"https://s3.amazonaws.com/asset.workaround.online/example-jobs/sticky-notes/image2.jpg"}]}},{name:"3D Bounding Box",Icon:xt.a,oha:{interface:{type:"3d_bounding_box",description:"3D Bounding Box"}}}],Ct=a(268),St=a.n(Ct),It=a(385),Dt=a.n(It),Tt=Object(l.a)({}),Nt=function(e){var t=e.recentItems,a=e.changeRecentItems,r=e.onClickHome,i=e.onCloseDrawer,l=e.drawerOpen,c=e.onOpenFile,s=e.onOpenRecentItem,u=e.onClickTemplate,m=Tt(),p=Object(n.useCallback)((function(e){c(e[0])}),[]);var d=Object(Ye.a)({onDrop:p}),f=d.getRootProps,g=d.getInputProps;return o.a.createElement(Ke.a,{open:l,onClose:i},o.a.createElement(Qe.a,{className:m.list},o.a.createElement(Xe.a,{onClick:r,button:!0},o.a.createElement($e.a,null,o.a.createElement(nt.a,null)),o.a.createElement(Ze.a,null,"Home")),o.a.createElement(Xe.a,Object.assign({},f(),{button:!0}),o.a.createElement($e.a,null,o.a.createElement(Dt.a,null)),o.a.createElement(Ze.a,null,"Open File"),o.a.createElement("input",g())),o.a.createElement(et.a,null,"Recent Files"),0===t.length?o.a.createElement(Xe.a,null,o.a.createElement(Ze.a,{style:{textAlign:"center",color:M.a[500]}},"No Recent Items")):t.map((function(e,n){return o.a.createElement(Xe.a,{key:e.fileName,button:!0},o.a.createElement($e.a,{onClick:function(){s(e)}},o.a.createElement(St.a,null)),o.a.createElement(Ze.a,{onClick:function(){s(e)}},e.fileName),o.a.createElement($e.a,{onClick:function(){var n;n=e.id,a(t.filter((function(e){return e.id!==n})))}},o.a.createElement(ot.b,null)))})),o.a.createElement(et.a,null,"Create From Template"),wt.map((function(e){return o.a.createElement(Xe.a,{key:e.name,onClick:function(){return u(e)}},o.a.createElement($e.a,null,o.a.createElement(e.Icon,null)),o.a.createElement(Ze.a,null,e.name))})),o.a.createElement(et.a,null,"Explore More"),o.a.createElement(Xe.a,{button:!0,onClick:function(){window.location.href="https://github.com/OpenHumanAnnotation/universal-data-tool/releases"}},o.a.createElement($e.a,null,o.a.createElement(tt.a,null)),o.a.createElement(Ze.a,null,"Github"))))},At=Object(n.createContext)({recentItems:[],changeRecentItems:function(){return null},onClickTemplate:function(){return null},onClickHome:function(){return null},onOpenFile:function(){return null},onOpenRecentItem:function(){return null},isDesktop:!1,inSession:!1,onJoinSession:function(){return null},onCreateSession:function(){return null},onLeaveSession:function(){return null},sessionBoxOpen:!1,changeSessionBoxOpen:function(){return null},fileOpen:!1,onDownload:function(){return null}}),Lt=[],Rt=function(e){var t=e.additionalButtons,a=void 0===t?Lt:t,r=e.title,i=e.currentTab,l=e.onChangeTab,c=e.tabs,s=void 0===c?Lt:c,u=Object(n.useState)(!1),m=Object(O.a)(u,2),p=m[0],d=m[1],f=Object(n.useContext)(At);f.recentItems||(f.recentItems=[]);var g=Object(x.a)("(max-width: 800px)"),b=Object(n.useCallback)((function(){return d(!0)}),[]),v=Object(n.useCallback)((function(){return d(!1)}),[]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ge,Object.assign({tabs:s,currentTab:i,onChangeTab:l,additionalButtons:a,onOpenDrawer:b,isSmall:g},f,{title:r})),o.a.createElement(Nt,{drawerOpen:p,onCloseDrawer:v,onClickHome:f.onClickHome,recentItems:f.recentItems,changeRecentItems:f.changeRecentItems,onOpenFile:f.onOpenFile,onClickTemplate:f.onClickTemplate,onOpenRecentItem:f.onOpenRecentItem}))},Bt=a(823),Pt=a(822),_t=a(821),Ut=a(820),Ft=a(819),zt=a(818),Mt=a(388),Wt=a.n(Mt),Ht=a(169),Vt=a.n(Ht),qt=a(387),Jt=a.n(qt),Gt=a(128),Kt=a.n(Gt),Yt=Object(z.a)(zt.a)({backgroundColor:M.a[100],borderBottom:"1px solid ".concat(M.a[300]),paddingBottom:12,boxShadow:"0px 2px 3px rgba(0,0,0,0.05)"}),Qt=Object(z.a)(Ft.a)({paddingTop:16}),Xt=Object(z.a)(Ut.a)({backgroundColor:M.a[100],borderTop:"1px solid ".concat(M.a[300])}),Zt=function(e){var t=e.open,a=void 0!==t&&t,r=e.title,i=e.children,l=e.markdownContent,c=e.onClose,s=e.red,u=e.noActionBar,p=void 0!==u&&u,d=e.actions,f=void 0===d?[]:d,g=Object(n.useState)(!1),b=Object(O.a)(g,2),v=b[0],h=b[1];return o.a.createElement(_t.a,{open:a,onClose:c,fullScreen:v},o.a.createElement(Yt,null,o.a.createElement(Pt.a,{display:"flex",alignItems:"center"},o.a.createElement("span",{style:{color:s?W.a[700]:void 0}},r),o.a.createElement("div",{style:{flexGrow:1}}),o.a.createElement(B.a,{onClick:function(){return h(!v)}},v?o.a.createElement(Jt.a,null):o.a.createElement(Vt.a,null)),o.a.createElement(B.a,{onClick:c},o.a.createElement(Wt.a,null)))),o.a.createElement(Qt,null,o.a.createElement(Pt.a,{maxWidth:"90vw",minWidth:400,lineHeight:1.5},l?o.a.createElement(Kt.a,{source:l}):i)),!p&&o.a.createElement(Xt,null,o.a.createElement(H.a,{onClick:function(){return c()}},o.a.createElement("span",{style:{color:M.a[700],fontWeight:500}},"Close")),f.map((function(e,t){return o.a.createElement(H.a,{disabled:e.disabled,key:t,onClick:e.onClick},o.a.createElement("span",{style:{color:s?W.a[700]:m.a[700],fontWeight:500}},e.text))}))))},$t=Object(l.a)({bigButton:{padding:10,width:150,height:120,border:"1px solid #ccc",margin:10},bigIcon:{width:48,height:48}}),ea=function(e){var t=e.open,a=e.onClose,n=e.onSelect,r=$t();return o.a.createElement(Zt,{title:"Create from Template",open:t,onClose:a},wt.map((function(e){return o.a.createElement(H.a,{key:e.name,onClick:function(){return n(e)},className:r.bigButton},o.a.createElement("div",null,o.a.createElement("div",null,e.name),o.a.createElement("div",null,o.a.createElement(e.Icon,{className:r.bigIcon}))))})))},ta=function(){return!!window.require&&Boolean(window.require("electron"))},aa=Object(l.a)({container:{display:"flex",flexDirection:"column",backgroundColor:M.a[900],height:"100vh"}}),na=Object(z.a)("div")((function(e){var t=e.theme;return Object(E.a)({display:"flex",justifyContent:"center",flexGrow:1,color:"#fff",overflowY:"scroll",padding:100},t.breakpoints.down("sm"),{padding:50})})),oa=Object(z.a)("div")((function(e){e.theme;return{display:"flex",flexDirection:"column",width:"calc(100% - 32px)",marginLeft:16,maxWidth:1e3}})),ra=Object(z.a)("div")({marginTop:20,fontSize:36,fontWeight:600,color:M.a[300]}),ia=Object(z.a)("div")({fontSize:18,marginTop:8,color:M.a[500]}),la=Object(z.a)("div")({marginTop:48}),ca=Object(z.a)("a")({display:"block",color:m.a[500],marginTop:4,cursor:"pointer",textDecoration:"none"}),sa=Object(z.a)("div")({fontSize:24,marginBottom:8,color:M.a[500]}),ua=Object(z.a)("div")({color:M.a[300],"& a":{cursor:"pointer",color:m.a[500],textDecoration:"none"}}),ma=Object(z.a)("div")({color:M.a[600],paddingTop:16}),pa=Object(z.a)("div")({height:100}),da=function(e){var t=e.onFileDrop,a=e.onOpenTemplate,r=e.showDownloadLink,i=void 0===r||r,l=e.recentItems,c=void 0===l?[]:l,s=e.onOpenRecentItem,u=e.onClickOpenSession,m=aa(),p=ee(),d=(ta(),Object(n.useState)(!1)),f=Object(O.a)(d,2),g=f[0],b=f[1];Object(n.useEffect)((function(){function e(){return(e=Object(h.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://raw.githubusercontent.com/UniversalDataTool/universal-data-tool/master/package.json").then((function(e){return e.json()}));case 2:(t=e.sent).version!==xe.version&&b(t.version);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var x=Object(n.useState)(!1),E=Object(O.a)(x,2),k=E[0],j=E[1],y=Object(De.a)((function(e){t(e[0])})),w=Object(Ye.a)({onDrop:y}),C=w.getRootProps,S=w.getInputProps;w.isDragActive;return o.a.createElement("div",{className:m.container},o.a.createElement(ea,{open:k,onSelect:function(e){p.capture("template_clicked",{clicked_template:e.name}),a(e)},onClose:function(){return j(!1)}}),o.a.createElement(Rt,{additionalButtons:[g&&o.a.createElement(H.a,{key:"download-latest",className:m.headerButton,href:"https://github.com/OpenHumanAnnotation/universal-data-tool/releases"},"Download Version v",g),!g&&i&&o.a.createElement(H.a,{key:"download",href:"https://github.com/OpenHumanAnnotation/universal-data-tool/releases",className:m.headerButton},"Download")].filter(Boolean)}),o.a.createElement(na,null,o.a.createElement(oa,null,o.a.createElement(Bt.a,{container:!0},o.a.createElement(Bt.a,{xs:12,item:!0},o.a.createElement(ra,null,"Universal Data Tool"),o.a.createElement(ia,null,"Open-Source Data Labeling")),o.a.createElement(Bt.a,{xs:6,item:!0},o.a.createElement(la,null,o.a.createElement(sa,null,"Start"),o.a.createElement(ca,{onClick:function(){p.capture("template_clicked",{clicked_template:"empty"}),a(wt.find((function(e){return"Empty"===e.name})))}},"New File"),o.a.createElement(ca,{onClick:function(){return j(!0)}},"Start from Template"),o.a.createElement(ca,C(),o.a.createElement("input",S()),"Open File"),u&&o.a.createElement(ca,{onClick:u},"Open Collaborative Session")),o.a.createElement(la,null,o.a.createElement(sa,null,"Recent"),0===c.length?o.a.createElement(ma,null,"No Recent Files"):c.map((function(e,t){return o.a.createElement(ca,{key:t,onClick:function(){return s(e)}},e.fileName)}))),o.a.createElement(la,null,o.a.createElement(sa,null,"Help"),o.a.createElement(ca,{href:"https://github.com/UniversalDataTool/universal-data-tool/releases"},"Downloading and Installing UDT"),o.a.createElement(ca,{href:"https://dev.to/seveibar/make-bounding-boxes-for-artificial-intelligence-with-udt-1kai"},"Labeling Images"),o.a.createElement(ca,{href:"https://github.com/UniversalDataTool/universal-data-tool"},"Github Repository"))),o.a.createElement(Bt.a,{xs:6,item:!0},o.a.createElement(la,null,o.a.createElement(sa,null,"About"),o.a.createElement(ua,null,"The Universal Data Tool (UDT) is an open-source web or downloadable tool for labeling data for usage in machine learning or data processing systems.",o.a.createElement("br",null),o.a.createElement("br",null),"The Universal Data Tool supports Computer Vision, Natural Language Processing (including Named Entity Recognition and Audio Transcription) workflows.",o.a.createElement("br",null),o.a.createElement("br",null),"The UDT uses an"," ",o.a.createElement("a",{href:"https://github.com/UniversalDataTool/udt-format"},"open-source data format (.udt.json / .udt.csv)")," ","that can be easily read by programs as a ground-truth dataset for machine learning algorithms.",o.a.createElement("br",null),o.a.createElement("br",null))),o.a.createElement(la,null,o.a.createElement(sa,null,"Instant Try Now"),o.a.createElement(ua,null,o.a.createElement("a",{onClick:function(){return j(!0)}},"Open a template")," ","to see how the UDT could work for your data."))),o.a.createElement(Bt.a,{xs:12,item:!0},o.a.createElement(pa,null))))))},fa=a(37),ga=(a(244),a(213)),ba=a.n(ga);'\n{\n  "interface": {\n    "type": "data_entry",\n    "description": "# Markdown description here",\n    "surveyjs": {\n      "questions": [\n        {\n          "type": "text",\n          "name": "question1",\n          "title": "Some question title here"\n        }\n      ]\n    }\n  },\n  "taskData": []\n}\n'.trim();function va(e){var t=e.description,a=e.imageUrl,n=e.url,o=e.pdfUrl;return t||(a?"![".concat(a,"](").concat(a,")"):o?"[PDF Link](".concat(o,")")+'<object data="'.concat(o.replace("http://","https://"),'" type="application/pdf" width="100%" height="600px"></object>'):n?"Use this [Link](".concat(n,")"):null)}var ha=a(64),Oa=a.n(ha),xa=a(161),Ea=a.n(xa),ka=a(389),ja=a.n(ka),ya=a(196),wa=a.n(ya),Ca=Object(l.a)({linkButtonContainer:{marginLeft:8,marginRight:8},linkButton:{textTransform:"none",cursor:"pointer",textDecoration:"underline"}}),Sa=function(e){var t=e.onClick,a=e.text,n=Ca();return o.a.createElement("span",{className:n.linkButtonContainer},"(",o.a.createElement("span",{onClick:t,className:n.linkButton},a),")")},Ia=a(84),Da=a.n(Ia),Ta=Object(l.a)((function(e){return{footer:{backgroundColor:"#fff",marginTop:40},footerContent:{alignItems:"center",padding:20,display:"flex",justifyContent:"space-between"},footerBorder:{borderTop:"1px solid #ccc",marginLeft:20,marginRight:20},footerCount:{display:"inline-flex"},allSamplesButton:{color:"#fff",border:"1px solid rgba(255,255,255,0.5)",marginRight:10,paddingLeft:8},sampleIcon:{marginRight:8},menuButton:{marginRight:8,color:"#fff"},grow:{flexGrow:1},buttons:{"& > *":{margin:4}},description:{padding:10,"& img":{maxWidth:"calc(100% - 16px)",marginLeft:8,marginRight:8,maxHeight:600}},sectionHeader:{fontWeight:700,fontSize:12,padding:10,paddingTop:16,textTransform:"uppercase",color:M.a[600]},content:{padding:10}}})),Na=function(e){var t=e.hideDescription,a=void 0===t?'"true"'===window.localStorage.getItem("hideDescription"):t,r=(e.lastSampleExitText,e.onExit),i=e.requireCompleteToPressNext,l=void 0!==i&&i,c=(e.taskData,e.minContentHeight),s=e.currentSampleIndex,u=e.totalSamples,p=e.onChangeSample,d=e.taskOutput,f=void 0===d?[]:d,g=e.description,b=e.children,v=Ta(),h=Object(n.useState)(a),x=Object(O.a)(h,2),E=x[0],k=x[1],j=function(e){window.localStorage.setItem("hideDescription",'"'.concat(e?"true":"false",'"')),k(e)},y=Object(n.useState)(!1),w=Object(O.a)(y,2),C=w[0],S=w[1];return o.a.createElement(o.a.Fragment,null,o.a.createElement(Bt.a,{container:!0},!E&&o.a.createElement(Bt.a,{item:!0,xs:12,sm:12,md:6},o.a.createElement("div",{className:v.sectionHeader},"Description",o.a.createElement(Sa,{onClick:function(){return j(!0)},text:"hide"})),o.a.createElement("div",{className:v.description},o.a.createElement(Kt.a,{escapeHtml:!1,source:g}))),o.a.createElement(Bt.a,{item:!0,xs:12,sm:12,md:E?12:6},o.a.createElement("div",{className:v.sectionHeader},"Sample ",s+1,"/",u,E&&o.a.createElement(Sa,{onClick:function(){return j(!1)},text:"show description"}),u>1&&o.a.createElement(Sa,{onClick:function(){return S(!0)},text:"view all"}),r&&o.a.createElement(Sa,{onClick:function(){return r()},text:"exit without saving"})),o.a.createElement("div",{style:{minHeight:c},className:v.content},b)),u>1&&o.a.createElement(Bt.a,{item:!0,xs:12},o.a.createElement("div",{className:v.footer},o.a.createElement("div",{className:v.footerBorder}),o.a.createElement("div",{className:v.footerContent},o.a.createElement(H.a,{onClick:function(){return p((s-1+u)%u)}},o.a.createElement(Ea.a,null)," Prev Sample"),o.a.createElement(H.a,{onClick:function(){return S(!0)},className:v.footerCount},s+1," / ",u),o.a.createElement(H.a,{disabled:l&&!f[s],onClick:function(){return p((s+1)%u)}},l&&!f[s]?"Save to Continue":"Next Sample",o.a.createElement(Oa.a,null)))))),o.a.createElement(Ke.a,{open:C,anchor:"left",onClose:function(){return S(!1)}},o.a.createElement(Qe.a,{style:{minWidth:300}},o.a.createElement(et.a,null,"Samples"),Da()(0,u).map((function(e){return o.a.createElement(Xe.a,{style:{backgroundColor:e===s?M.a[200]:void 0},button:!0,onClick:function(){return p(e)}},o.a.createElement($e.a,{style:{color:e===s?m.a[500]:void 0}},f[e]?o.a.createElement(wa.a,null):o.a.createElement(ja.a,null)),o.a.createElement(Ze.a,null,"Sample ",e+1))})))))},Aa=a(132),La=function(e){var t=Object(n.useState)(0),a=Object(O.a)(t,2),r=a[0],i=a[1],l=e.taskOutput&&e.taskOutput[r]?[e.taskOutput[r].label]||!1:void 0,c=e.interface.labels.map((function(e){return"string"===typeof e?{id:e,description:e,displayName:e}:e})).map((function(e){return e.displayName?e:Object(g.a)({},e,{displayName:e.id})}));return o.a.createElement(Na,Object.assign({},e.containerProps,{currentSampleIndex:r,totalSamples:e.taskData.length,taskOutput:e.taskOutput,description:va(e.taskData[r])||e.interface.description,onChangeSample:function(e){return i(e)}}),o.a.createElement(Aa.a,{key:(e.sampleIndex||0)+r,type:"label-document",labels:c,multipleLabels:e.interface.multiple,document:e.taskData[r].document,initialLabels:l,onFinish:function(t){t="string"===typeof t?{label:t}:{labels:t},e.onSaveTaskOutputItem(r,t),e.containerProps.onExit&&e.containerProps.onExit("go-to-next")}}))},Ra=a(43),Ba=function(e){var t,a=[],n=0,o=Object(Ra.a)(e);try{for(o.s();!(t=o.n()).done;){var r=t.value;r.label&&a.push({text:r.text,label:r.label,start:n,end:n+r.text.length}),n+=r.text.length}}catch(i){o.e(i)}finally{o.f()}return a},Pa=function(e){var t=Object(n.useState)(0),a=Object(O.a)(t,2),r=a[0],i=a[1],l=e.taskOutput&&e.taskOutput[r]?function(e,t){if(t){var a=[];(t=Object(fa.a)(t)).sort((function(e,t){return e.start-t.start}));for(var n=0,o=0;o<e.length;o++)(t[n]||{}).start===o?(a.push({text:t[n].text,label:t[n].label}),o=t[n].end,n+=1):0===a.length||a[a.length-1].label?a.push({text:e[o]}):a[a.length-1].text+=e[o];return a}}(e.taskData[r].document,e.taskOutput[r].entities):void 0;return o.a.createElement(Na,Object.assign({},e.containerProps,{currentSampleIndex:r,totalSamples:e.taskData.length,taskOutput:e.taskOutput,description:va(e.taskData[r])||e.interface.description,onChangeSample:function(e){return i(e)}}),o.a.createElement(Aa.a,{key:r,type:"label-sequence",document:e.taskData[r].document,labels:e.interface.labels,initialSequence:l,onFinish:function(t){e.onSaveTaskOutputItem(r,{entities:Ba(t)}),e.containerProps.onExit&&e.containerProps.onExit("go-to-next")}}))},_a=a(224);a(56);function Ua(){var e,t,a=(e=0,t=360,Math.floor(Math.random()*(t-e+1))+e);return"hsl(".concat(a.toString(),",").concat(100..toString(),"%,").concat(50..toString(),"%)")}for(var Fa=function(){return Math.random().toString().split(".")[1]},za=function(e){switch(e.regionType){case"bounding-box":return{id:Fa(),cls:e.classification,tags:e.labels,color:e.color||Ua(),type:"box",x:e.centerX-e.width/2,y:e.centerY-e.height/2,w:e.width,h:e.height};case"point":return{id:Fa(),type:"point",tags:e.labels,cls:e.classification,color:e.color||Ua(),x:e.x,y:e.y};case"polygon":return{id:Fa(),type:"polygon",tags:e.labels,cls:e.classification,color:e.color||Ua(),open:!1,points:e.points.map((function(e){return[e.x,e.y]}))};case"line":case"pixel-mask":throw new Error('Unsupported region "'.concat(JSON.stringify(e),'"'))}},Ma=function(e){switch(e.type){case"point":return{regionType:"point",x:e.x,y:e.y,classification:e.cls,labels:e.tags,color:e.color};case"box":return{regionType:"bounding-box",centerX:e.x+e.w/2,centerY:e.y+e.h/2,width:e.w,height:e.h,classification:e.cls,labels:e.tags,color:e.color};case"polygon":return{regionType:"polygon",classification:e.cls,labels:e.tags,color:e.color,points:e.points.map((function(e){var t=Object(O.a)(e,2);return{x:t[0],y:t[1]}}))}}throw new Error('Unsupported riaRegion "'.concat(JSON.stringify(e),'"'))},Wa=function(e){var t={};for(var a in e)t[a]={regions:e[a].regions.map(za)};return t},Ha=Object(l.a)({}),Va={"bounding-box":"create-box",polygon:"create-polygon","full-segmentation":"create-polygon",point:"create-point"},qa={},Ja=[],Ga=function(e){var t=e.interface,a=e.taskData,r=void 0===a?Ja:a,i=e.taskOutput,l=void 0===i?qa:i,c=e.containerProps,s=void 0===c?qa:c,u=e.onSaveTaskOutputItem,m=(Ha(),Object(n.useState)(0)),p=Object(O.a)(m,2),d=p[0],f=(p[1],t.regionTypesAllowed),b=void 0===f?["bounding-box"]:f,v=!Boolean(t.multipleRegionLabels),h=Object(n.useMemo)((function(){return v?{regionClsList:(t.availableLabels||[]).map((function(e){return"string"===typeof e?e:e.id}))}:{regionTagList:(t.availableLabels||[]).map((function(e){return"string"===typeof e?e:e.id}))}}),[v]),x=t.multipleRegions||void 0===t.multipleRegions,E=Object(De.a)((function(e){for(var t=(e.images||[]).map((function(e){return e.regions})).map((function(e){return(e||[]).map(Ma)})),a=0;a<t.length;a++)u(a,x?t[a]:t[a][0]);s.onExit&&s.onExit()})),k=Object(n.useMemo)((function(){return r.map((function(e,t){return function(e){var t=e.title,a=e.taskDatum,n=e.index,o=e.output;a=a||{};var r=o?Array.isArray(o)?o.map(za):[za(o)]:void 0;if(a.imageUrl)return{src:a.imageUrl,name:t||"Sample ".concat(n),regions:r};if(a.videoUrl&&void 0!==a.videoFrameAt)return{src:a.videoUrl,frameTime:a.videoFrameAt,name:t||"Sample ".concat(n),regions:r};throw new Error('Task Datum not supported "'.concat(JSON.stringify(a),'"'))}({title:s.datasetName,taskDatum:e,output:l[t],index:t})}))}),[r]),j=Object(n.useMemo)((function(){return["select"].concat(b.map((function(e){return Va[e]})).filter(Boolean))}),[b]);return console.log(Object(g.a)({selectedImage:r[d].imageUrl,taskDescription:t.description},h,{enabledTools:j,images:k,onExit:E})),o.a.createElement("div",{style:{height:"calc(100vh - 70px)"}},o.a.createElement(_a.a,Object.assign({selectedImage:r[d].imageUrl,taskDescription:t.description},h,{enabledTools:j,images:k,onExit:E})))},Ka=a(311),Ya=a(310),Qa=a(369),Xa=a(412),Za=a.n(Xa),$a=[m.a[600],ue.a[600],W.a[600],je.a[600],we.a[600],Ka.a[600],Ya.a[600],Ie.a[600],m.a[600],Ce.a[600],ye.a[600]],en="abcdefghijklmnopqrstuvwxyz1234567890".split(""),tn=function(e){var t=e.id.split("").reduce((function(e,t,a){return e+(en.indexOf(t)+1)}),0);return $a[t%$a.length]},an=Object(z.a)("div")({maxWidth:"100vw"}),nn=Object(z.a)("div")({maxHeight:"50vh"}),on=Object(z.a)("img")({display:"inline-block",width:"100%",height:"100%",maxHeight:"50vh",objectFit:"contain"}),rn=Object(z.a)("div")({display:"flex",justifyContent:"center",marginTop:4}),ln=Object(z.a)("div")({backgroundColor:"#000",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center","& > span":{padding:16}}),cn=Object(z.a)(H.a)({color:"#fff",padding:8,paddingLeft:16,paddingRight:16}),sn=Object(z.a)("div")({paddingLeft:50,paddingRight:50,marginTop:8,textAlign:"center"}),un=Object(z.a)(H.a)({margin:8,color:"#fff",fontSize:18,paddingRight:16,transition:"transform 50ms ease"}),mn={},pn=[],dn=function(e){var t=e.sampleIndex,a=e.interface,r=e.taskData,i=void 0===r?pn:r,l=e.taskOutput,c=void 0===l?mn:l,s=e.containerProps,u=void 0===s?mn:s,m=e.onSaveTaskOutputItem,p=Object(n.useState)(0),d=Object(O.a)(p,2),f=d[0],g=d[1],b=Object(n.useState)(null),v=Object(O.a)(b,2),h=v[0],x=v[1],E=Object(n.useState)(pn),k=Object(O.a)(E,2),j=k[0],y=k[1],w=Object(n.useMemo)((function(){return a.availableLabels.map((function(e){return"string"===typeof e?{id:e,description:e}:e}))}),[a.availableLabels]),C=Object(De.a)((function(e){u.onExit&&u.onExit()})),S=Object(De.a)((function(e){m(f,e||j),f!==i.length-1?g(f+1):u.onExit&&u.onExit("go-to-next")})),I=Object(De.a)((function(){f>0?g(f-1):u.onExit&&u.onExit("go-to-previous")}));Object(n.useEffect)((function(){var e=setTimeout((function(){x(null)}),100);return function(){return clearTimeout(e)}}),[h]);var D=Object(De.a)((function(e){var t;x(e),t=(j||[]).includes(e.id)?Za()(j,e.id):a.allowMultiple?j.concat([e.id]):e.id,y(t),!a.allowMultiple&&t.length>0&&S(t)}));Object(n.useEffect)((function(){var e=(c||[])[f];e||(e=[]),"string"===typeof e&&(e=[e]),y(e)}),[f,t]);var T=Object(n.useMemo)((function(){var e,t={" ":S,backspace:I,enter:C,rightarrow:S,leftarrow:I},a={},n=Object(Ra.a)(w);try{var o=function(){var n=e.value,o=n.id.split("").filter((function(e){return en.includes(e)})).find((function(e){return!t[e.toLowerCase()]}));if(!o)return"continue";t[o]=function(){return D(n)},a[n.id]=o};for(n.s();!(e=n.n()).done;)o()}catch(r){n.e(r)}finally{n.f()}return[t,a]}),[w]),N=Object(O.a)(T,2),A=N[0],L=N[1];return Object(n.useEffect)((function(){var e=function(e){var t=e.key.toLowerCase();A[t]&&A[t]()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[A]),o.a.createElement(an,null,o.a.createElement(nn,null,o.a.createElement(on,{src:i[f].imageUrl})),o.a.createElement(rn,null,o.a.createElement(ln,null,o.a.createElement(cn,{onClick:I},"Prev (backspace)")),i.length>1?o.a.createElement(ln,null,o.a.createElement("span",null,"(",f+1,"/",i.length,")")):void 0!==t?o.a.createElement(ln,null,o.a.createElement("span",null,"[",t,"]")):null,o.a.createElement(ln,null,o.a.createElement(cn,{onClick:S},"Next (space)")),o.a.createElement(ln,null,o.a.createElement(cn,{onClick:C},"Done (enter)"))),o.a.createElement(sn,null,w.map((function(e){return o.a.createElement(un,{key:e.id,onClick:function(){return D(e)},style:{backgroundColor:tn(e),transform:h===e?"scale(1.1,1.1)":void 0}},o.a.createElement(Qa.a,{style:{color:"#fff"},checked:j.includes(e.id)}),e.id,L[e.id]?" (".concat(L[e.id],")"):"")}))))},fn=Object(l.a)({}),gn={"bounding-box":"create-box",polygon:"create-polygon","full-segmentation":"create-polygon",point:"create-point"},bn={},vn=[],hn=function(e){var t=e.interface,a=e.taskData,r=void 0===a?vn:a,i=e.taskOutput,l=void 0===i?bn:i,c=e.containerProps,s=void 0===c?bn:c,u=e.onSaveTaskOutputItem,m=(fn(),Object(n.useState)(0)),p=Object(O.a)(m,2),d=(p[0],p[1],t.regionTypesAllowed),f=void 0===d?["bounding-box"]:d,g=!Boolean(t.multipleRegionLabels),b=Object(n.useMemo)((function(){return g?{regionClsList:(t.availableLabels||[]).map((function(e){return"string"===typeof e?e:e.id}))}:{regionTagList:(t.availableLabels||[]).map((function(e){return"string"===typeof e?e:e.id}))}}),[g]),v=(t.multipleRegions||t.multipleRegions,Object(De.a)((function(e){var t={};for(var a in e.keyframes)t[a]={regions:e.keyframes[a].regions.map(Ma)};u(0,{keyframes:t}),s.onExit&&s.onExit()}))),h=Object(n.useMemo)((function(){return["select"].concat(f.map((function(e){return gn[e]})).filter(Boolean))}),[f]);return r.length>1?"Video segmentation is currently limited to only a single video per selection":0===r.length?"taskData[0] with videoUrl is required":r[0].videoUrl?o.a.createElement("div",{style:{height:"calc(100vh - 70px)"}},o.a.createElement(_a.a,Object.assign({taskDescription:t.description},b,{enabledTools:h,keyframes:Wa(((l||[])[0]||{}).keyframes),videoName:r[0].customId||"",videoTime:0,videoSrc:r[0].videoUrl,onExit:v}))):"taskData[0] must have videoUrl"},On=function(e){var t=Object(n.useState)(0),a=Object(O.a)(t,2),r=a[0],i=a[1];return o.a.createElement(Na,Object.assign({},e.containerProps,{currentSampleIndex:r,totalSamples:e.taskData.length,taskOutput:e.taskOutput,description:va(e.taskData[r])||e.interface.description,onChangeSample:function(e){return i(e)}}),o.a.createElement(Aa.a,{key:(e.sampleIndex||0)+r,type:"transcribe",audio:e.taskData[r].audioUrl,phraseBank:e.phraseBank,initialTranscriptionText:(e.taskOutput||[])[r]||"",onFinish:function(t){e.onSaveTaskOutputItem(r,t),e.containerProps.onExit&&e.containerProps.onExit("go-to-next")}}))},xn=a(44),En=a.n(xn),kn=function(e){var t=Object(n.useState)(0),a=Object(O.a)(t,2),r=a[0],i=a[1];return o.a.createElement(Na,Object.assign({},e.containerProps,{currentSampleIndex:r,totalSamples:e.taskData.length,taskOutput:e.taskOutput,description:va(e.taskData[r])||e.interface.description,onChangeSample:function(e){return i(e)}}),o.a.createElement(En.a,{key:(e.sampleIndex||0)+r,variant:"flat",form:e.taskData[r].surveyjs||e.interface.surveyjs,defaultAnswers:e.taskOutput&&e.taskOutput[r]?e.taskOutput[r]:void 0,completeText:"Save & Next",onFinish:function(t){e.onSaveTaskOutputItem(r,t),e.containerProps.onExit&&e.containerProps.onExit("go-to-next")}}))},jn=a(95),yn=Object(l.a)({root:{padding:50,textAlign:"center"},title:{margin:50},explain:{}}),wn=function(e){var t=e.title,a=e.description,n=e.children,r=yn();return o.a.createElement("div",{className:r.root},o.a.createElement(jn.a,{variant:"h3",component:"div",className:r.title},t),o.a.createElement(jn.a,{variant:"h5",component:"div",className:r.explain},a||n))},Cn=function(){return o.a.createElement(wn,{title:"No Samples to Show"},"Make sure that ",o.a.createElement("code",null,"taskData")," is defined and not empty.",o.a.createElement("br",null),o.a.createElement("br",null),"Need help setting up? ",o.a.createElement("a",{href:"#"},"Check out this tutorial."))},Sn=a(226),In=a(413),Dn=a.n(In),Tn=a(272),Nn=a.n(Tn),An=function(e){var t=e.type,a=Object(Sn.a)(e,["type"]);switch(t){case"image_label":case"image_segmentation":return o.a.createElement(Dn.a,a);case"audio_transcription":return o.a.createElement(bt.a,a);case"data_entry":return o.a.createElement(ft.a,a);case"text_entity_recognition":return o.a.createElement(pt.a,a);case"3d_bounding_box":return o.a.createElement(xt.a,a);default:return o.a.createElement(Nn.a,a)}},Ln=Object(z.a)("div")({fontSize:18,fontWeight:"bold",color:M.a[700],borderBottom:"1px solid ".concat(M.a[300]),paddingBottom:8,marginBottom:8,paddingLeft:8}),Rn=Object(z.a)(H.a)({display:"flex",textAlign:"left",justifyContent:"flex-start",marginTop:8}),Bn=function(e){var t=Object(n.useState)(0),a=Object(O.a)(t,2),r=a[0],i=a[1],l=e.interface.fields,c=Object(n.useState)(),s=Object(O.a)(c,2),u=s[0],m=s[1],p=Object(n.useState)(e.taskOutput),d=Object(O.a)(p,2);d[0],d[1];return u?o.a.createElement(Pn,{oha:{interface:u.interface,taskOutput:[e.taskOutput?(e.taskOutput[r]||{})[u.fieldName]:null],taskData:[e.taskData[r]]},onSaveTaskOutputItem:function(t,a){e.onSaveTaskOutputItem(r,Object(g.a)({},e.taskOutput?e.taskOutput[r]:{},Object(E.a)({},u.fieldName,a))),m(null)}}):(console.log("taskOutput",e.taskOutput),o.a.createElement(Na,Object.assign({},e.containerProps,{currentSampleIndex:r,totalSamples:e.taskData.length,taskOutput:e.taskOutput,description:va(e.taskData[r])||e.interface.description,onChangeSample:function(e){return i(e)}}),o.a.createElement(Ln,null,"Fields"),l.map((function(t,a){return o.a.createElement(Rn,{key:t.fieldName,onClick:function(){m(Object(g.a)({},t,{index:a}))},fullWidth:!0,variant:"outlined"},o.a.createElement(An,{style:{color:M.a[500],marginRight:16},type:t.interface.type}),t.fieldName,o.a.createElement(Pt.a,{flexGrow:1}),o.a.createElement(Qa.a,{checked:Boolean((e.taskOutput&&e.taskOutput[r]||{})[t.fieldName])}),o.a.createElement(Oa.a,null))})),o.a.createElement(Rn,{onClick:function(){return e.containerProps.onExit("go-to-next")},fullWidth:!0,variant:"outlined"},o.a.createElement(Oa.a,{style:{color:M.a[500],marginRight:16}}),"Next",o.a.createElement(Pt.a,{flexGrow:1}),o.a.createElement(Pt.a,{height:"42px"}),o.a.createElement(Oa.a,null))))},Pn=function(e){var t=e.oha,a=e.onExit,r=e.hideHeader,i=e.hideDescription,l=e.datasetName,c=e.requireCompleteToPressNext,s=e.onSaveTaskOutputItem,u=Object(n.useMemo)((function(){return{hideHeader:r,hideDescription:i,datasetName:l,requireCompleteToPressNext:c,onExit:a}}),[r,i,c,l,a]);if(!t)return o.a.createElement(wn,{title:"Null OHA",description:"Your OHA file isn't defined for some reason."});if(!t.taskData||0===t.taskData.length)return o.a.createElement(Cn,null);switch(t.interface.type){case"data_entry":return o.a.createElement(kn,Object.assign({containerProps:u},t,{onSaveTaskOutputItem:s,onExit:a}));case"text_classification":return o.a.createElement(La,Object.assign({containerProps:u},t,{onSaveTaskOutputItem:s,onExit:a}));case"text_entity_recognition":return o.a.createElement(Pa,Object.assign({containerProps:u},t,{onSaveTaskOutputItem:s,onExit:a}));case"image_segmentation":return o.a.createElement(Ga,Object.assign({containerProps:u},t,{onExit:a,onSaveTaskOutputItem:s}));case"image_classification":return o.a.createElement(dn,Object.assign({containerProps:u},t,{onExit:a,onSaveTaskOutputItem:s}));case"video_segmentation":return o.a.createElement(hn,Object.assign({containerProps:u},t,{onExit:a,onSaveTaskOutputItem:s}));case"composite":return o.a.createElement(Bn,Object.assign({containerProps:u},t,{oha:t,onSaveTaskOutputItem:s,onExit:a}));case"audio_transcription":return o.a.createElement(On,Object.assign({containerProps:u},t,{onSaveTaskOutputItem:s,onExit:a}));default:return'"'.concat(t.interface.type,'" not supported')}},_n=Object(l.a)({textField:{marginLeft:8}}),Un=function(e){var t=e.value,a=e.onChange,r=_n(),i=Object(n.useState)({editing:!1,newValue:t||""}),l=Object(O.a)(i,2),c=l[0],s=c.editing,u=c.newValue,m=l[1];return Object(n.useEffect)((function(){m({editing:s,newValue:t})}),[t]),Object(n.useEffect)((function(){if(s){var e=function(e){"Enter"===e.key&&(a(u),m({editing:!1}))};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}}),[s,u]),Object(n.useEffect)((function(){if(u){if(s){var e=setTimeout((function(){a(u),m({editing:!1})}),t===u?1e4:2e3);return function(){return clearTimeout(e)}}return function(){}}}),[s,u]),o.a.createElement(V.a,{className:r.textField,label:"File Name",variant:"outlined",size:"small",InputProps:{inputProps:{style:{color:"#000"}}},onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),e.target.blur())},onKeyPress:function(e){e.stopPropagation()},onChange:function(e){m({editing:!0,newValue:e.target.value})},value:u||""})},Fn=a(414),zn=a.n(Fn),Mn=a(75),Wn=a.n(Mn),Hn=a(31),Vn=a.n(Hn),qn=a(839),Jn=Object(z.a)("div")({flexWrap:"wrap"}),Gn=Object(z.a)("div")((function(e){var t=e.color;return{margin:4,padding:4,backgroundColor:t[500],display:"inline-flex",fontSize:11,textAlign:"center",justifyContent:"center",minWidth:"3em",borderRadius:3,cursor:"pointer",userSelect:"none",transition:"box-shadow 200ms ease, transform 200ms ease",color:t.isFaded?"#000":"#fff","&.selected":{boxShadow:"0px 0px 2px 1px ".concat(t.A200),transform:"scale(1.05,1.05)"}}})),Kn=Object(n.memo)((function(e){var t=e.index,a=e.onClick,n=e.completed,r=e.selected,i=e.onMouseDown,l=e.onMouseUp,c=e.onMouseEnter,s=e.brush;return o.a.createElement(Gn,{className:Vn()({completed:n,selected:r}),onClick:function(){return a(t)},onMouseDown:function(){return i(t)},onMouseUp:function(){return l(t)},onMouseEnter:function(){return c(t)},color:Ue(s)},t)}),(function(e,t){return e.index===t.index&&e.completed===t.completed&&e.selected===t.selected&&e.brush===t.brush})),Yn=function(e){var t=e.count,a=e.completed,r=void 0===a?[]:a,i=e.taskData,l=e.onClick,c=Object(R.a)("samplesPerPage",100),s=Object(O.a)(c,2),u=s[0],m=s[1],p=Object(R.a)("sampleOffset",0),d=Object(O.a)(p,2),f=d[0],g=d[1];Object(n.useEffect)((function(){f>t&&g(0)}),[]);var b=Object(n.useReducer)((function(e,t){return null===t?null:"number"===typeof t?e?[Math.min(t,e[0]),Math.max(t+1,e[1])]:null:t}),null),v=Object(O.a)(b,2),h=v[0],x=v[1],E=Object(n.useCallback)((function(e){return x([e,e+1])}),[x]),k=Object(n.useCallback)((function(e){return x(e)}),[x]),j=Object(n.useCallback)((function(){}),[x]),y=Object(n.useCallback)((function(e){1!==e.buttons&&x(null)}),[x]),w=Object(De.a)(l);return o.a.createElement(Jn,{onMouseUp:y,onMouseEnter:y},Da()(f,Math.min(t,f+u)).map((function(e){return o.a.createElement(Kn,{onClick:w,key:e,index:e,completed:r[e],brush:r[e]?i[e].brush||"complete":"incomplete",selected:h&&e>=h[0]&&e<h[1],onMouseDown:E,onMouseEnter:k,onMouseUp:j})})),o.a.createElement(qn.a,{rowsPerPageOptions:[100,250,500,1e3,2e3,1e4],component:"div",count:t,rowsPerPage:u,page:Math.floor(f/u),labelRowsPerPage:"Samples per Page:",onChangePage:function(e,t){return g(t*u)},onChangeRowsPerPage:function(e){return m(+e.target.value)}}))},Qn=a(418),Xn=a.n(Qn),Zn=a(417),$n=a.n(Zn),eo=a(419),to=a.n(eo),ao=a(416),no=a.n(ao),oo=a(274),ro=a.n(oo),io=a(275),lo=a.n(io),co=a(276),so=a.n(co),uo=a(162),mo=a.n(uo),po=a(277),fo=a.n(po),go=Object(z.a)("textarea")({width:"100%",minHeight:300}),bo=function(e){var t=e.open,a=e.onClose,r=e.onAddSamples,i=Object(n.useState)(""),l=Object(O.a)(i,2),c=l[0],s=l[1];return o.a.createElement(Zt,{title:"Paste Urls",open:t,onClose:a,actions:[{text:"Add Samples",onClick:function(){r(c.split("\n").map((function(e){return e.trim()})).filter(Boolean).map((function(e){switch(e.replace(/\?.*/g,"").split(".").slice(-1)[0].toLowerCase()){case"png":case"jpg":case"gif":case"jpeg":case"bmp":return{imageUrl:e};case"pdf":return{pdfUrl:e};case"mp3":case"wav":return{audioUrl:e};default:return console.error("extension not recognized"),null}})).filter(Boolean))}}]},o.a.createElement(go,{onChange:function(e,t){return s(e.target.value)},placeholder:"Paste URLs here\nOne URL per line"}))},vo=Object(z.a)("textarea")({width:"100%",minHeight:300}),ho=Object(z.a)("div")({fontSize:24,color:M.a[600],textAlign:"center",padding:48}),Oo=function(){return null},xo=function(e){var t=e.content,a=e.onChangeContent,r=e.placeholder,i=Object(De.a)((function(e){e[0].name;var t=new FileReader;t.onload=function(e){var t=e.target.result;a(t)},t.readAsText(e[0])})),l=Object(n.useState)(0),c=Object(O.a)(l,2),s=c[0],u=c[1],m=Object(De.a)((function(e){Date.now()-s<400&&d().onClick(e),u(Date.now())})),p=Object(Ye.a)({onDrop:i}),d=p.getRootProps,f=p.getInputProps,g=p.isDragActive;return o.a.createElement("div",Object.assign({},d(),{onClick:Oo}),o.a.createElement("input",f()),g?o.a.createElement(ho,null,"Drop the text or csv file here."):o.a.createElement(vo,{value:t,onChange:function(e,t){return a(e.target.value)},onClick:m,placeholder:r}))},Eo=function(e){var t=e.open,a=e.onClose,r=e.onAddSamples,i=Object(n.useState)(""),l=Object(O.a)(i,2),c=l[0],s=l[1];return o.a.createElement(Zt,{open:t,onClose:a,title:"Import Text Snippets",actions:[{text:"Add Samples",onClick:function(){r(c.split("\n").map((function(e){return e.trim()})).filter(Boolean).map((function(e){return{document:e}})))}}]},o.a.createElement(xo,{content:c,onChangeContent:s,placeholder:"Paste Snippets here\nOne snippet per line.\n\nYou can also drag a text or csv file here (double click to open file dialog)"}))},ko=a(6),jo=a.n(ko),yo=Object(z.a)("div")({marginTop:8,marginBottom:8}),wo=Object(z.a)("img")({width:"100%",boxSizing:"border-box"}),Co={web:{client_id:"856114516731-rndo792s25bjjno28jltd70ipajlb917.apps.googleusercontent.com",app_id:"856114516731",developer_key:"AIzaSyD7hdWRB_uz-RE-xDJEew-jFYjIv3lO4Qc"}},So=function(e){var t=e.open,a=e.onClose,r=e.onAddSamples,i=Object(n.useState)(!1),l=Object(O.a)(i,2),c=l[0],s=l[1],u=Object(n.useState)(!1),m=Object(O.a)(u,2),p=m[0],d=m[1],f=Object(n.useState)(null),g=Object(O.a)(f,2),b=g[0],v=g[1],h=Object(n.useState)([]),x=Object(O.a)(h,2),E=x[0],k=x[1],j=Object(n.useState)(!1),y=Object(O.a)(j,2),w=y[0],C=y[1];Object(n.useEffect)((function(){var e=document.createElement("script");return e.src="https://apis.google.com/js/api.js",e.async=!0,e.onload=function(){s(!0)},document.body.appendChild(e),function(){e.remove()}}),[]);var S=function(e){e.action===window.google.picker.Action.PICKED?(k(e.docs.map((function(e){return{url:e.url,mimeType:e.mimeType,name:e.name,id:e.id}}))),C(!1)):"cancel"===e.action&&a()},I=function(){if(p&&b){var e=new window.google.picker.View(window.google.picker.ViewId.Docs);e.setMimeTypes("image/png","image/jpeg","image/jpg","image/gif","video/mp4","video/mpeg"),(new window.google.picker.PickerBuilder).enableFeature(window.google.picker.Feature.NAV_HIDDEN).enableFeature(window.google.picker.Feature.MULTISELECT_ENABLED).setAppId(Co.web.app_id).setOAuthToken(b).addView(e).addView(window.google.picker.ViewId.DOCS).setDeveloperKey(Co.web.developer_key).setCallback(S).build().setVisible(!0),C(!0)}};Object(n.useEffect)((function(){I()}),[p,b]);var D=function(e){e&&!e.error&&(v(e.access_token),I())},T=function(){window.gapi.auth.authorize({client_id:Co.web.client_id,scope:"https://www.googleapis.com/auth/drive.readonly",immediate:!1},D)},N=function(){d(!0),I()},A=function(){!0===c&&(window.gapi.load("auth",{callback:T}),window.gapi.load("picker",{callback:N}))};return Object(n.useEffect)((function(){t&&A()}),[t,c]),o.a.createElement(Zt,{open:t&&!w,onClose:a,title:"Import from Google Drive",actions:[E&&E.length>0&&{text:"Add ".concat(E.length," Samples"),onClick:function(){var e,t=[],a=Object(Ra.a)(E);try{for(a.s();!(e=a.n()).done;){var n=e.value;n.mimeType.includes("image/")?t.push({imageUrl:"https://drive.google.com/uc?id=".concat(n.id)}):n.mimeType.includes("video/")&&t.push({videoUrl:"https://drive.google.com/uc?id=".concat(n.id)})}}catch(o){a.e(o)}finally{a.f()}r(t)}}].filter(Boolean)},o.a.createElement(H.a,{variant:"outlined",onClick:A},"Reopen Google Drive Picker"),o.a.createElement(yo,null,"Make sure your Google Drive files are available via a link."," ",o.a.createElement("b",null,"If you don't, the files will not appear when you're labeling!")),o.a.createElement(wo,{src:"https://s3.amazonaws.com/asset.workaround.online/google-share-screenshot.png"}))},Io=a(222),Do=a.n(Io),To={},No=0,Ao=Object.entries({imageUrl:["image_url","image_urls","image","image_src","img_url","img","img_src"],document:["text"]});No<Ao.length;No++){var Lo,Ro=Object(O.a)(Ao[No],2),Bo=Ro[0],Po=Ro[1],_o=Object(Ra.a)(Po);try{for(_o.s();!(Lo=_o.n()).done;){var Uo=Lo.value;To[Uo]=Bo}}catch(ec){_o.e(ec)}finally{_o.f()}}var Fo=function(e){for(var t in e){var a=t.toLowerCase().replace(/ /g,"_"),n=To[a];n&&(e[n]=e[t],delete e[t])}return e},zo=function(e){var t=Do.a.fromCSV(e,{derivePath:function(){return"samples.*"}});if(!t.samples)throw new Error("No samples");return{interface:t.interface,taskOutput:t.samples.map((function(e){return e.output})),taskData:t.samples.map(Fo).map((function(e){return delete e.output,e}))}},Mo=Object(z.a)("div")({fontFamily:"Inter",marginBottom:20,"& a":{color:m.a[500]}}),Wo=Object(z.a)("div")({color:W.a[500],whiteSpace:"pre-wrap",marginBottom:20}),Ho=function(e){var t=e.open,a=e.onClose,r=e.onAddSamples,i=Object(n.useState)(null),l=Object(O.a)(i,2),c=l[0],s=l[1],u=Object(n.useState)(""),m=Object(O.a)(u,2),p=m[0],d=m[1];return o.a.createElement(Zt,{open:t,onClose:a,title:"Import JSON/CSV Samples",actions:[{text:"Add Samples",onClick:function(){var e,t;s(null);try{var a=Object(O.a)(JSON.parse(p).taskData,2);e=a[0],t=a[1]}catch(o){try{var n=zo(p);e=n.taskData,t=n.taskOutput}catch(i){return console.log({message:"CSV/JSON Error Stacks",jsonError:o.stack,csvError:i.stack}),void s("JSON did not parse. CSV did not parse.\n\nJSON Error: ".concat(o.toString(),"\nCSV Error: ").concat(i.toString()))}}e&&0!==e.length?r(e,t):s("No task data found")}}]},o.a.createElement(Mo,null,"See the"," ",o.a.createElement("a",{target:"_blank",href:"https://github.com/UniversalDataTool/udt-format"},"UDT JSON format")," ","or the"," ",o.a.createElement("a",{target:"_blank",href:"https://github.com/UniversalDataTool/udt-format"},"UDT CSV format")," ","for formatting details. Or take a look at a"," ",o.a.createElement("a",{target:"_blank",href:"https://github.com/UniversalDataTool/udt-format/blob/master/SAMPLE.udt.json"},"sample JSON")," ","or"," ",o.a.createElement("a",{target:"_blank",href:"https://github.com/UniversalDataTool/udt-format/blob/master/SAMPLE.udt.csv"},"sample CSV")," ","file."),o.a.createElement(Wo,null,c),o.a.createElement(xo,{content:p,onChangeContent:d,placeholder:"Paste CSV/JSON here. The file should be in the UDT JSON/CSV format.\n\nYou can also drag a json or csv file here (double click to open file dialog)"}))},Vo=a(827),qo=a(830),Jo=a(825),Go=a(826),Ko=a(828),Yo=a(829),Qo=[{name:"Elon Musk Tweets",type:"text",size:2800},{name:"Cats",type:"image",size:360},{name:"VR Hand Pinching",type:"image",size:20517},{name:"AI Generated Faces",type:"image",size:1999},{name:"Text to Speech Audio",type:"audio",size:200}];function Xo(e){return Zo.apply(this,arguments)}function Zo(){return(Zo=Object(h.a)(v.a.mark((function e(t){var a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.name.toLowerCase().replace(/ /g,"_")+".udt.json",n="https://s3.amazonaws.com/datasets.workaround.online/".concat(a),e.next=4,fetch(n).then((function(e){return e.json()})).then((function(e){return e.taskData}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $o=Object(z.a)(H.a)({}),er=function(e){var t=e.onClose,a=e.onAddSamples,n=e.open;return o.a.createElement(Zt,{onClose:t,open:n,title:"Import Toy Dataset"},o.a.createElement(Go.a,null,o.a.createElement(Vo.a,null,o.a.createElement(Ko.a,null,o.a.createElement(Yo.a,null,o.a.createElement(Jo.a,null,"Name"),o.a.createElement(Jo.a,null,"Type"),o.a.createElement(Jo.a,null,"Size"),o.a.createElement(Jo.a,null,"Actions"))),o.a.createElement(qo.a,null,Qo.map((function(e){return o.a.createElement(Yo.a,{key:e.name},o.a.createElement(Jo.a,null,e.name),o.a.createElement(Jo.a,null,e.type),o.a.createElement(Jo.a,null,e.size),o.a.createElement(Jo.a,null,o.a.createElement($o,{onClick:Object(h.a)(v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=a,t.next=3,Xo(e);case 3:t.t1=t.sent,(0,t.t0)(t.t1);case 5:case"end":return t.stop()}}),t)}))),variant:"outlined"},"Import")))}))))))},tr=a(85),ar=function(e){var t=e.youtubeUrl,a=e.title,n=e.remote,o=e.videoQuality,r=e.downloadPath,i=e.onProgress,l=e.onComplete,c=e.overallProgress,s=(Date.now(),n.require("ytdl-core")),u=n.require("path"),m=o.includes("audio")?"".concat(a+".mp3"):"".concat(a+".mp4"),p=u.join(r,m),d=n.require("fs").createWriteStream(p),f=s(t,{format:m.endsWith(".mp3")?"audio/mp3":"video/mp4",quality:null!==o?o:"highest"});return f.pipe(d),f.once("response",(function(){Date.now()})),f.on("progress",(function(e,t,a){var n=t/a;i({progress:100*n}),c(100*n)})),f.on("end",(function(){return l(p)})),{cancel:function(){f.destroy()}}},nr=Object(z.a)("div")({height:36,width:"100%",boxSizing:"border-box",position:"relative",marginTop:8,marginBottom:8,backgroundColor:m.a[50]}),or=Object(z.a)("div")({position:"absolute",left:0,right:0,top:0,bottom:0,paddingTop:4,fontSize:18,textAlign:"center",fontWeight:"bold"}),rr=Object(z.a)("div")({position:"absolute",left:0,bottom:0,top:0,backgroundColor:m.a[300]}),ir=function(e){var t=e.progress;return o.a.createElement(nr,null,o.a.createElement(rr,{style:{right:100-t+"%"}}),o.a.createElement(or,null,Math.floor(t),"%"))},lr=a(841),cr=a(130),sr=a.n(cr),ur=a(831),mr=a(832),pr=Object(z.a)("div")({width:"100%",height:"100%"}),dr=Object(z.a)("div")({flexDirection:"row",width:"100%",display:"flex",justifyContent:"space-between"}),fr=function(e){var t=e.unitProgress,a=e.overallProgress,n=e.completedVideoTitles;return o.a.createElement(pr,null,o.a.createElement(ir,{progress:a}),o.a.createElement(ir,{progress:t.progress}),o.a.createElement("h3",null,"Downloading: ",t.title),o.a.createElement(lr.a,null,o.a.createElement(ur.a,{expandIcon:o.a.createElement(sr.a,null)},o.a.createElement(dr,null,o.a.createElement("h3",null,"Downloaded Video Titles"))),o.a.createElement(mr.a,null,o.a.createElement("ul",null,n&&n.length>0?n:null))))},gr=function(){var e=Object(h.a)(v.a.mark((function e(t,a){var n,o,r,i,l,c=arguments;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>2&&void 0!==c[2]?c[2]:function(){return null},o=t.require("ytdl-core"),r=[],!(a.length>0)){e.next=11;break}i=v.a.mark((function e(t){var i,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a[t],e.next=3,new Promise((function(e,t){o.getBasicInfo(i,(function(a,n){if(n&&!a)e({url:i,title:n.title});else{var o='Error with video at "'.concat(i,'"\n\n').concat(a.toString());t(new Error(o))}}))}));case 3:l=e.sent,r.push(l),n({progress:t/(a.length-1)*100,text:"Inspecting Video Information..."});case 6:case"end":return e.stop()}}),e)})),l=0;case 6:if(!(l<a.length)){e.next=11;break}return e.delegateYield(i(l),"t0",8);case 8:l++,e.next=6;break;case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),br=function(e){var t,a=[],n=e.split("\n"),o=Object(Ra.a)(n);try{for(o.s();!(t=o.n()).done;){var r=t.value;r.includes("https://")&&a.push(r)}}catch(ec){o.e(ec)}finally{o.f()}return a},vr=Object(z.a)("textarea")({width:"100%",minHeight:300}),hr=Object(z.a)("h3")({lineHeight:0,textAlign:"center"}),Or=Object(z.a)("div")({width:"100%",marginBottom:8,paddingBottom:4}),xr=Object(z.a)("pre")({whiteSpace:"pre-wrap",color:"#f00"}),Er=Object(z.a)("h2")({width:"100%",height:"100%",margin:"auto auto",textAlign:"center"}),kr=Object(z.a)("h3")({textDecoration:"line-through",lineHeight:0}),jr=[{value:"lowestvideo",label:"Lowest Video Only"},{value:"lowest",label:"lowest"},{value:"highest",label:"Highest"},{value:"highestvideo",label:"Highest Video Only"},{value:"lowestaudio",label:"Lowest Audio Only"},{value:"highestaudio",label:"Highest Audio Only"}],yr=function(e){var t=e.open,a=e.onClose,r=e.onAddSamples,i=($()||{}).remote,l=Object(n.useState)([]),c=Object(O.a)(l,2),s=c[0],u=c[1],m=Object(n.useState)("lowest"),p=Object(O.a)(m,2),d=p[0],f=p[1],g=Object(n.useState)(null),b=Object(O.a)(g,2),x=(b[0],b[1]),E=Object(n.useState)(null),k=Object(O.a)(E,2),j=k[0],y=k[1],w=Object(n.useState)({progress:0}),C=Object(O.a)(w,2),S=C[0],I=C[1],D=Object(n.useState)(0),T=Object(O.a)(D,2),N=T[0],A=T[1],L=Object(n.useState)(!1),R=Object(O.a)(L,2),B=R[0],P=R[1],_=Object(n.useState)(null),U=Object(O.a)(_,2),F=U[0],z=U[1],M=Object(n.useRef)(),W=function(){var e=Object(h.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I({progress:0,title:""}),A(0),P(!1);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(h.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W();case 2:a();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.a.createElement(Zt,{open:t,onClose:H,title:"Import from Youtube URLs",actions:[{text:"Cancel Downloads",disabled:!B,onClick:function(){M.current(),P(!1)}},{text:"Download Youtube URLs",onClick:function(){var e=Object(h.a)(v.a.mark((function e(){var t,a,n,l,c,u,m,p,f,g;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.next=3,i.dialog.showOpenDialog({title:"Directory to download files to",buttonLabel:"Download Files Here",properties:["createDirectory","openDirectory","promptToCreate"]});case 3:if(t=e.sent,a=t.canceled,n=t.filePaths,!a&&n){e.next=8;break}return e.abrupt("return",P(!1));case 8:return l=n[0],x(l),e.next=12,gr(i,s,(function(e){var t=e.progress;e.text;I({progress:t})})).catch((function(e){return console.error(e.stack),y(e.toString()),null}));case 12:if(c=e.sent){e.next=15;break}return e.abrupt("return",P(!1));case 15:u=[],m=[],p=c.length,f=v.a.mark((function e(t){var a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c[t],e.next=3,new Promise((function(e,t){var n=ar({remote:i,downloadPath:l,youtubeUrl:a.url,title:a.title,videoQuality:d,overallProgress:function(e){return A((100*m.length+e)/(100*p)*100)},onProgress:function(e){var t=e.progress,n=e.text;return I({progress:t,title:a.title,progressText:n})},onComplete:function(t){return e(t)}}).cancel;M.current=n}));case 3:n=e.sent,m.push(o.a.createElement("li",{key:t+a.title},o.a.createElement(kr,null,a.title))),z(m),u.push(n);case 7:case"end":return e.stop()}}),e)})),g=0;case 20:if(!(g<p)){e.next=25;break}return e.delegateYield(f(g),"t0",22);case 22:g++,e.next=20;break;case 25:r(u.map((function(e){return{videoUrl:"file://".concat(e)}}))),P(!1);case 27:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),disabled:B}]},j&&o.a.createElement(xr,null,j),B&&(S&&S.progress&&S.progress>0||F&&!0===Array.isArray(F)&&F.length>0)?o.a.createElement(fr,{unitProgress:S,completedVideoTitles:F,overallProgress:N}):!0===B?o.a.createElement(Er,null,"Information is Loading"):null,!B&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Or,null,o.a.createElement(hr,null,"Select Video Quality"),o.a.createElement(tr.default,{defaultValue:jr[0],options:jr,onChange:function(e){var t=e.value;return f(t)}})),o.a.createElement(vr,{onChange:function(e,t){u(br(e.target.value))},placeholder:"Paste Youtube URLs here\nOne URL per line"})))},wr=Object(z.a)(H.a)({width:240,height:140,display:"inline-flex",flexDirection:"column","&.disabled":{backgroundColor:M.a[200]},margin:8,"& .icon":{width:48,height:48,color:M.a[600],"&.disabled":{color:M.a[400]}}}),Cr=Object(z.a)("div")({fontSize:11,fontWeight:"bold",color:M.a[600],"&.disabled":{color:M.a[500]}}),Sr=Object(n.createContext)(),Ir=function(e){var t=e.Icon,a=e.desktopOnly,n=e.isDesktop,r=e.children,i=e.dialog,l=!!a&&!n;return o.a.createElement(Sr.Consumer,null,(function(e){var n=e.onChangeDialog;return o.a.createElement(wr,{onClick:function(){return n(i)},className:Vn()({disabled:l}),variant:"outlined",disabled:l},o.a.createElement("div",null,o.a.createElement(t,{className:Vn()("icon",{disabled:l})}),o.a.createElement("div",null,r),a&&o.a.createElement(Cr,{className:Vn()({disabled:l})},"DESKTOP ONLY")))}))},Dr=function(e){var t=e.split(".").slice(-1)[0].toLowerCase();return["png","jpg","jpeg"].includes(t)?{imageUrl:"file://".concat(e)}:["pdf"].includes(t)?{pdfUrl:"file://".concat(e)}:["mp4","webm","mkv"].includes(t)?{videoUrl:"file://".concat(e)}:null},Tr=function(e){var t=e.oha,a=e.onChangeOHA,r=e.isDesktop,i=Object(n.useState)(),l=Object(O.a)(i,2),c=l[0],s=l[1],u=$(),m=function(){var e=Object(h.a)(v.a.mark((function e(n){var o,r,i,l,c,m,p;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n,e.next="upload-directory"===e.t0?3:20;break;case 3:if(u){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,u.remote.dialog.showOpenDialog({title:"Select Directory to Import Files",properties:["openDirectory"]});case 7:if(o=e.sent,r=o.canceled,i=o.filePaths,!r){e.next=12;break}return e.abrupt("return");case 12:return l=i[0],c=u.remote.require("fs"),m=u.remote.require("path"),e.next=17,c.promises.readdir(l);case 17:return p=e.sent.filter((function(e){return e.includes(".")})).map((function(e){return m.join(l,e)})),a(Object(ko.setIn)(t,["taskData"],(t.taskData||[]).concat(p.map(Dr).filter(Boolean))),!0),e.abrupt("return");case 20:return e.abrupt("return",s(n));case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){return s(null)},d=Object(De.a)((function(e,n){var o=Object(ko.setIn)(t,["taskData"],(t.taskData||[]).concat(e));n&&(o=Object(ko.setIn)(o,["taskOutput"],function(e,t){for(e=Object(fa.a)(e);e.length<t;)e.push(null);return e}(t.taskOutput||[],t.taskData.length).concat(n))),a(o,!0),p()}));return o.a.createElement(Sr.Provider,{value:{onChangeDialog:m}},o.a.createElement("div",null,o.a.createElement(Ir,{isDesktop:r,dialog:"paste-image-urls",Icon:ro.a},"Paste URLs"),o.a.createElement(Ir,{desktopOnly:!0,isDesktop:r,dialog:"upload-directory",Icon:lo.a},"Files from Directory"),o.a.createElement(Ir,{dialog:"import-text-snippets",Icon:so.a},"Import Text Snippets"),o.a.createElement(Ir,{isDesktop:r,dialog:"import-toy-dataset",Icon:fo.a},"Import Toy Dataset"),o.a.createElement(Ir,{isDesktop:r,dialog:"google-drive-file-picker",Icon:ot.a},"Import from Google Drive"),o.a.createElement(Ir,{isDesktop:r,dialog:"youtube-urls",Icon:ot.c,desktopOnly:!0},"Import from Youtube URLs"),o.a.createElement(Ir,{isDesktop:r,dialog:"import-csv-json",Icon:mo.a},"Import from CSV / JSON"),o.a.createElement(Eo,{open:"import-text-snippets"===c,onClose:p,onAddSamples:d}),o.a.createElement(bo,{open:"paste-image-urls"===c,onClose:p,onAddSamples:d}),o.a.createElement(So,{open:"google-drive-file-picker"===c,onClose:p,onAddSamples:d}),o.a.createElement(er,{open:"import-toy-dataset"===c,onClose:p,onAddSamples:d}),o.a.createElement(yr,{open:"youtube-urls"===c,onClose:p,onAddSamples:d}),o.a.createElement(Ho,{open:"import-csv-json"===c,onClose:p,onAddSamples:d})))},Nr=Object(z.a)("pre")({fontSize:8}),Ar=Object(z.a)(lr.a)({backgroundColor:M.a[100],border:"1px solid ".concat(M.a[500]),marginTop:16,marginBottom:16}),Lr=Object(z.a)(ur.a)({fontWeight:"bold"}),Rr=function(e){var t=e.open,a=e.onChangeOHA,n=e.onClose,r=e.oha;return o.a.createElement(Zt,{open:t,onClose:n,title:"Transform Video Keyframes",actions:[{text:"Transform Video Keyframes",disabled:!r.taskOutput,onClick:function(){var e=r.taskData.flatMap((function(e,t){if(!e.videoUrl)return{data:e,output:r.taskOutput[t]};if(e.videoUrl&&!e.videoFrameAt){if(!r.taskOutput[t])return[];if(!r.taskOutput[t].keyframes)return[];var a=r.taskOutput[t].keyframes;return Object.keys(a).map((function(t){return{data:{videoUrl:e.videoUrl,videoFrameAt:parseInt(t)},output:a[t].regions||[]}}))}}));a(jo()(r).setIn(["taskData"],e.map((function(e){return e.data}))).setIn(["taskOutput"],e.map((function(e){return e.output}))).setIn(["interface","type"],"image_segmentation"))}}]},'This operation will convert keyframes set on a video into individual image segmentation frames. Your interface type will change from "video_segmentation" into "image_segmentation". This is sometimes helpful when preparing video data for a computer vision model.',!r.taskOutput&&o.a.createElement("b",null,o.a.createElement("br",null),o.a.createElement("br",null),"You need to label some keyframes to use this."),o.a.createElement(Ar,null,o.a.createElement(Lr,null,"Details"),o.a.createElement(mr.a,null,o.a.createElement(Pt.a,{display:"flex"},o.a.createElement(Pt.a,null,o.a.createElement(Nr,null,'{\n  "interface": { "type": "video_segmentation" },\n  taskData: [\n    {\n      videoUrl: "https://example.com/video1.mp4"\n    }\n  ],\n  taskOutput: [\n    {\n      keyframes: {\n        "0": { /* labels */ },\n        "1000": { /* labels */ },\n        "2000": { /* labels */ }\n      }\n    }\n  ]\n}')),o.a.createElement(Pt.a,{display:"flex",justifyContent:"center",alignItems:"center"},o.a.createElement(F.a,{style:{color:M.a[500],width:48,height:48}})),o.a.createElement(Pt.a,null,o.a.createElement(Nr,null,'{\n  "interface": { "type": "image_segmentation" },\n  taskData: [\n    {\n      videoUrl: "https://example.com/vid1.mp4",\n      videoFrameAt: 0\n    },\n    {\n      videoUrl: "https://example.com/vid1.mp4",\n      videoFrameAt: 1000\n    },\n    {\n      videoUrl: "https://example.com/vid1.mp4",\n      videoFrameAt: 2000\n    }\n  ],\n  taskOutput: [\n    { /* labels */ },\n    { /* labels */ },\n    { /* labels */ }\n  ]\n}'))))))},Br=a(278),Pr=a.n(Br),_r=a(159),Ur=a.n(_r),Fr=Object(z.a)("pre")({color:"red",whiteSpace:"prewrap",fontSize:11});function zr(e,t,a){var n="sample_".concat(Pr()(e).slice(0,6),"__").concat(e.split("/").slice(-1)[0].replace(/[^a-zA-Z0-9_\-\.]/g,"")),o=Ur.a.join(t,n);return a.require("fs").existsSync(o)?o:new Promise((function(r,i){a.require("download-file")(e,{directory:t,filename:n},(function(e){return e?i(e):r(o)}))}))}var Mr=function(e){var t=e.open,a=e.onChangeOHA,r=e.onClose,i=e.oha,l=($()||{}).remote,c=Object(n.useState)(null),s=Object(O.a)(c,2),u=s[0],m=s[1],p=Object(n.useState)(""),d=Object(O.a)(p,2),f=d[0],b=d[1];return o.a.createElement(Zt,{open:t,onClose:r,title:"Download URLs",actions:[{text:"Download URLs",disabled:null!==u,onClick:function(){var e=Object(h.a)(v.a.mark((function e(){var t,n,o,r,c,s,u,p,d,f,h,x;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(0),e.next=3,l.dialog.showOpenDialog({title:"Directory to download files to",buttonLabel:"Download Files Here",properties:["createDirectory","openDirectory","promptToCreate"]});case 3:if(t=e.sent,n=t.cancelled,o=void 0===(o=t.filePaths)?[null]:o,r=Object(O.a)(o,1),c=r[0],!n&&c){e.next=11;break}return m(null),e.abrupt("return");case 11:s=Object(fa.a)(i.taskData),u="",p=0;case 14:if(!(p<i.taskData.length)){e.next=36;break}if(d=i.taskData[p],f=void 0,d.imageUrl&&(f="imageUrl"),d.videoUrl&&(f="videoUrl"),f&&d[f].startsWith("http")){e.next=21;break}return e.abrupt("continue",33);case 21:return h=d[f],e.prev=22,e.next=25,zr(h,c,l);case 25:x=e.sent,s[p]=Object(g.a)({},d,Object(E.a)({},f,"file://".concat(x))),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(22),u+="Skipping sample, error downloading taskData[".concat(p,"] (").concat(h,"): ").concat(e.t0.toString()," \n");case 32:m(p/i.taskData.length*100);case 33:p++,e.next=14;break;case 36:a(Object(ko.setIn)(i,["taskData"],s)),b(u),m(100);case 39:case"end":return e.stop()}}),e,null,[[22,29]])})));return function(){return e.apply(this,arguments)}}()}]},"This transformation will download all the urls from your samples to your computer, and change the paths to filenames. This is usually not a good idea if you're collaborating with others, but is very useful if you're about to build a model.",o.a.createElement(ir,{progress:u||0}),f&&o.a.createElement(Fr,null,f))},Wr=a(217),Hr=a.n(Wr),Vr=Object(z.a)("pre")({color:"red",whiteSpace:"prewrap",fontSize:11}),qr=function(e){var t=Math.floor(e/10)%100,a=Math.floor(e/1e3)%60,n=Math.floor(e/1e3/60)%60;return[Math.floor(e/1e3/60/60),":",n,":",a,".",t].map((function(e){return"number"===typeof e?e.toString().padStart(2,"0"):e})).join("")},Jr=function(e){var t=e.open,a=e.onChangeOHA,r=e.onClose,i=e.oha,l=($()||{}).remote,c=Object(n.useState)(null),s=Object(O.a)(c,2),u=s[0],m=s[1],p=Object(n.useState)(""),d=Object(O.a)(p,2),f=d[0],b=d[1];return o.a.createElement(Zt,{open:t,onClose:r,title:"Convert Video Frames to Images",actions:[{text:"Convert Video Frames to Images",disabled:null!==u,onClick:function(){var e=Object(h.a)(v.a.mark((function e(){var t,n,o,r,c,s,u,p,d;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m(0),t="",(n=l.require("ffmpeg-static"))||b("There was an issue using ffmpeg. Please create an issue on the github repository."),o=l.require("any-shell-escape"),r=l.require("child_process"),c=r.exec,s=Object(fa.a)(i.taskData),u=0,p=0;case 9:if(!(p<i.taskData.length)){e.next=20;break}if(!(d=i.taskData[p]).videoUrl||void 0===d.videoFrameAt){e.next=16;break}return e.delegateYield(v.a.mark((function e(){var a,r,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.videoUrl.startsWith("http")){e.next=3;break}return t+="Sample ".concat(p," has a url to a video, videos must be downloaded before extracting frames."),e.abrupt("return","continue");case 3:return u++,a=d.videoUrl.replace(/^file:\/\//,""),r=a+"__frameat__"+d.videoFrameAt+".jpg",l=o([n,"-y","-ss",qr(d.videoFrameAt),"-i",a,"-frames:v",1,r]),console.log("running:",l),e.next=10,new Promise((function(e,t){c(l,{timeout:5e3},(function(a){if(a)return t(a);e()}))}));case 10:s[p]=Object(g.a)({},Object(ko.without)(Object(ko.without)(i.taskData[p],"videoUrl"),"videoFrameAt"),{imageUrl:"file://".concat(r)});case 11:case"end":return e.stop()}}),e)}))(),"t0",13);case 13:if("continue"!==e.t0){e.next=16;break}return e.abrupt("continue",17);case 16:m(p/i.taskData.length*100);case 17:p++,e.next=9;break;case 20:0===u&&(t+="No transforms were performed, do all of your video samples have frames specified? You may need to convert the keyframes to samples."),a(Object(ko.setIn)(i,["taskData"],s)),b(t),m(100);case 24:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]},"This transformation will convert samples that reference a video frame into an image. This is a useful step before creating a model. You can only convert videos that are downloaded on your computer. Note: This can take a little while.",o.a.createElement(ir,{progress:u||0}),f&&o.a.createElement(Vr,null,f))},Gr=Object(z.a)(H.a)({width:240,height:140,display:"inline-flex",flexDirection:"column","&.disabled":{backgroundColor:M.a[200]},margin:8,"& .icon":{width:36,height:36,color:M.a[600],"&.disabled":{color:M.a[400]}}}),Kr=Object(z.a)("div")({fontSize:11,fontWeight:"bold",color:M.a[600],"&.disabled":{color:M.a[500]}}),Yr=Object(n.createContext)(),Qr=function(e){var t=e.Icon1,a=e.Icon2,n=e.desktopOnly,r=e.children,i=e.dialog,l=e.disabled,c=ta();return l=void 0===l?!!n&&!c:l,o.a.createElement(Yr.Consumer,null,(function(e){var c=e.onChangeDialog;return o.a.createElement(Gr,{onClick:function(){return c(i)},className:Vn()({disabled:l}),variant:"outlined",disabled:l},o.a.createElement("div",null,t&&a?o.a.createElement(o.a.Fragment,null,o.a.createElement(t,{className:Vn()("icon",{disabled:l})}),o.a.createElement(F.a,{className:Vn()("icon",{disabled:l})}),o.a.createElement(a,{className:Vn()("icon",{disabled:l})})):o.a.createElement(t,{className:Vn()("icon",{disabled:l})}),o.a.createElement("div",null,r),n&&o.a.createElement(Kr,{className:Vn()({disabled:l})},"DESKTOP ONLY")))}))},Xr=function(e){var t=e.oha,a=e.onChangeOHA,r=Object(n.useState)(),i=Object(O.a)(r,2),l=i[0],c=i[1],s=($(),function(){var e=Object(h.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=(e.t0,3);break;case 3:return e.abrupt("return",c(t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u=function(){return c(null)};return o.a.createElement(Yr.Provider,{value:{onChangeDialog:s}},o.a.createElement("div",null,o.a.createElement(Qr,{disabled:"video_segmentation"!==t.interface.type,dialog:"convert-keyframes-to-samples",Icon1:kt.a,Icon2:Hr.a},"Convert Video Keyframes to Samples"),o.a.createElement(Qr,{desktopOnly:!0,dialog:"download-urls",Icon1:se.a},"Download URLs"),o.a.createElement(Qr,{desktopOnly:!0,dialog:"convert-video-frames-to-images",Icon1:kt.a,Icon2:ct.a},"Convert Video Frames to Images"),o.a.createElement(Rr,{open:"convert-keyframes-to-samples"===l,onClose:u,oha:t,onChangeOHA:function(){a.apply(void 0,arguments),u()}}),o.a.createElement(Mr,{open:"download-urls"===l,onClose:u,oha:t,desktopOnly:!0,onChangeOHA:a}),o.a.createElement(Jr,{open:"convert-video-frames-to-images"===l,onClose:u,oha:t,desktopOnly:!0,onChangeOHA:a})))},Zr=Object(z.a)("div")({padding:16}),$r=Object(z.a)("div")({padding:8,border:"#888 solid 1px",borderTop:"none",borderRadius:4,borderTopLeftRadius:0,borderTopRightRadius:0,boxShadow:"inset 0 3px 3px rgba(0,0,0,0.2)"}),ei=Object(z.a)("div")({fontSize:11,fontWeight:"bold"}),ti=Object(z.a)("pre")({whiteSpace:"pre-wrap",fontSize:11}),ai=function(e){var t=e.data,a=t._output,n=Object(Sn.a)(t,["_output"]);return o.a.createElement($r,null,o.a.createElement(Bt.a,{spacing:2,container:!0},o.a.createElement(Bt.a,{item:!0,xs:6},o.a.createElement(ei,null,"taskData[",t.index,"]:"),o.a.createElement(ti,null,JSON.stringify(n,null,"  "))),o.a.createElement(Bt.a,{item:!0,xs:6},o.a.createElement(ei,null,"taskOutput[",t.index,"]:"),o.a.createElement(ti,null,JSON.stringify(a,null,"  ")))))},ni=function(e){var t=e.oha,a=e.openSampleInputEditor,r=e.openSampleLabelEditor,i=e.deleteSample,l=e.onChangeOHA,c=ta(),s=Object(n.useState)(0===(t.taskData||[]).length?"import":window.localStorage.lastSampleTab||"grid"),u=Object(O.a)(s,2),m=u[0],p=u[1],d=function(e){p(e),window.localStorage.lastSampleTab=e},f=Object(n.useMemo)((function(){if(!t.taskData)return[];var e,n=[{name:"Index",selector:"index",sortable:!0}],l=new Set,c=Object(Ra.a)(t.taskData);try{for(c.s();!(e=c.n()).done;){var s=e.value;for(var u in s)l.has(u)||(n.push({name:u,selector:u}),l.add(u))}}catch(ec){c.e(ec)}finally{c.f()}return n.push({name:"Edit",button:!0,cell:function(e){return o.a.createElement(B.a,{raised:!0,onClick:function(){return a(e.index)}},o.a.createElement(ft.a,{style:{width:20,height:20}}))}}),n.push({name:"Label",button:!0,cell:function(e){return o.a.createElement(B.a,{raised:!0,onClick:function(){return r(e.index)}},o.a.createElement(N.a,{style:{width:20,height:20}}))}}),n.push({name:"Delete",button:!0,cell:function(e){return o.a.createElement(B.a,{raised:!0,primary:!0,onClick:function(){return i(e.index)}},o.a.createElement(Wn.a,{style:{width:20,height:20}}))}}),n}),[t.taskData,t.taskOutput]),b=Object(n.useMemo)((function(){return t.taskData?t.taskData.map((function(e,a){return Object(g.a)({},e,{_output:t.taskOutput&&t.taskOutput[a]?t.taskOutput[a]:{},index:a})})):[]}),[t.taskData,t.taskOutput]);return o.a.createElement(Zr,null,o.a.createElement(y.a,{value:m,onChange:function(e,t){return d(t)}},o.a.createElement(w.a,{icon:o.a.createElement(no.a,null),label:"Import",value:"import"}),o.a.createElement(w.a,{icon:o.a.createElement($n.a,null),label:"Transform",value:"transform"}),o.a.createElement(w.a,{icon:o.a.createElement(Xn.a,null),label:"Grid",value:"grid"}),o.a.createElement(w.a,{icon:o.a.createElement(to.a,null),label:"Table",value:"table"})),o.a.createElement(Pt.a,{paddingTop:2}),"import"===m&&o.a.createElement(Tr,{isDesktop:c,onChangeOHA:function(e,t){l(e),t&&d("grid")},oha:t}),"transform"===m&&o.a.createElement(Xr,{isDesktop:c,oha:t,onChangeOHA:function(e,t){l(e),t&&d("grid")}}),"grid"===m&&o.a.createElement(Yn,{count:(t.taskData||[]).length,taskData:t.taskData||[],completed:(t.taskOutput||[]).map(Boolean),onClick:function(e){r(e)}}),"table"===m&&o.a.createElement(zn.a,{title:"Samples",expandableRowsComponent:o.a.createElement(ai,null),expandableRows:!0,dense:!0,columns:f,data:b,pagination:!0,paginationPerPage:10,paginationRowsPerPageOptions:[10,20,25,50,100,200]}))},oi={questions:[{name:"regionTypesAllowed",title:"Region Types Allowed",description:"What types of regions can be drawn on the image.",type:"multiple-dropdown",choices:["bounding-box","polygon","point"]},{name:"multipleRegions",title:"Can multiple regions be created?",type:"boolean"},{name:"multipleRegionLabels",title:"Multiple Region Labels Allowed?",type:"boolean"},{name:"availableLabels",title:"Available Labels",description:"If you're labeling regions on an image, these are the allowed classifications or tags.",type:"matrixdynamic",columns:[{cellType:"text",name:"id",title:"id"},{cellType:"text",name:"description",title:"Description (optional)"}]}]},ri=function(e){var t=e.iface,a=e.onChange,r=Object(n.useMemo)((function(){return{multipleRegions:Boolean(t.multipleRegions||void 0===t.multipleRegions),multipleRegionLabels:Boolean(t.multipleRegionLabels),regionTypesAllowed:t.regionTypesAllowed,availableLabels:(t.availableLabels||[]).map((function(e){return"string"===typeof e?{id:e,description:e}:e}))||[]}}),[]);return o.a.createElement(En.a,{noActions:!0,variant:"flat",defaultAnswers:r,onQuestionChange:function(e,n,o){a(Object(ko.setIn)(t,[e],n))},form:oi})},ii={questions:[{name:"allowMultiple",title:"Allow multiple classifications per image?",type:"boolean"},{name:"availableLabels",title:"Available Labels",description:"Classifications or tags to be labeled.",type:"matrixdynamic",columns:[{cellType:"text",name:"id",title:"id"},{cellType:"text",name:"description",title:"Description (optional)"}]}]},li=function(e){var t=e.iface,a=e.onChange,r=Object(n.useMemo)((function(){return{allowMultiple:!1,availableLabels:(t.availableLabels||[]).map((function(e){return"string"===typeof e?{id:e,description:e}:e}))||[]}}),[]);return o.a.createElement(En.a,{noActions:!0,variant:"flat",defaultAnswers:r,onQuestionChange:function(e,n,o){a(Object(ko.setIn)(t,[e],n))},form:ii})},ci={questions:[{name:"multiple",title:"Allow Multiple Classifications",type:"boolean"},{name:"labels",title:"Labels",description:"Classifications or tags to be labeled.",type:"matrixdynamic",columns:[{cellType:"text",name:"id",title:"id"},{cellType:"text",name:"displayName",title:"Display Name"},{cellType:"text",name:"description",title:"Description (optional)"}]}]},si=function(e){var t=e.iface,a=e.onChange,r=Object(n.useMemo)((function(){return{multiple:!1,labels:(t.labels||[]).map((function(e){return"string"===typeof e?{id:e,displayName:e,description:e}:e}))||[]}}),[]);return o.a.createElement(En.a,{noActions:!0,variant:"flat",defaultAnswers:r,onQuestionChange:function(e,n,o){a(Object(ko.setIn)(t,[e],n))},form:ci})},ui=Object(z.a)("div")({margin:16,padding:16,border:"1px solid #ccc",borderRadius:4,boxShadow:"0px 2px 2px rgba(0,0,0,0.1)"}),mi={questions:[{name:"transcriptionType",title:"Transcription Type",type:"dropdown",choices:["simple","proper"]},{name:"phraseBank",title:"Phrase Bank",description:"URL of single-column CSV or TXT file with allowed phrases",type:"text"},{name:"onlyUseWordsInPhraseBank",title:"Only Use Words In Phrase Bank",type:"boolean"},{name:"language",title:"Language",type:"dropdown",choices:[{value:"ab",text:"Abkhazian"},{value:"aa",text:"Afar"},{value:"af",text:"Afrikaans"},{value:"ak",text:"Akan"},{value:"sq",text:"Albanian"},{value:"am",text:"Amharic"},{value:"ar",text:"Arabic"},{value:"an",text:"Aragonese"},{value:"hy",text:"Armenian"},{value:"as",text:"Assamese"},{value:"av",text:"Avaric"},{value:"ae",text:"Avestan"},{value:"ay",text:"Aymara"},{value:"az",text:"Azerbaijani"},{value:"bm",text:"Bambara"},{value:"ba",text:"Bashkir"},{value:"eu",text:"Basque"},{value:"be",text:"Belarusian"},{value:"bn",text:"Bengali"},{value:"bh",text:"Bihari languages"},{value:"bi",text:"Bislama"},{value:"bs",text:"Bosnian"},{value:"br",text:"Breton"},{value:"bg",text:"Bulgarian"},{value:"my",text:"Burmese"},{value:"ca",text:"Catalan, Valencian"},{value:"km",text:"Central Khmer"},{value:"ch",text:"Chamorro"},{value:"ce",text:"Chechen"},{value:"ny",text:"Chichewa, Chewa, Nyanja"},{value:"zh",text:"Chinese"},{value:"cu",text:"Church Slavonic, Old Bulgarian, Old Church Slavonic"},{value:"cv",text:"Chuvash"},{value:"kw",text:"Cornish"},{value:"co",text:"Corsican"},{value:"cr",text:"Cree"},{value:"hr",text:"Croatian"},{value:"cs",text:"Czech"},{value:"da",text:"Danish"},{value:"dv",text:"Divehi, Dhivehi, Maldivian"},{value:"nl",text:"Dutch, Flemish"},{value:"dz",text:"Dzongkha"},{value:"en",text:"English"},{value:"eo",text:"Esperanto"},{value:"et",text:"Estonian"},{value:"ee",text:"Ewe"},{value:"fo",text:"Faroese"},{value:"fj",text:"Fijian"},{value:"fi",text:"Finnish"},{value:"fr",text:"French"},{value:"ff",text:"Fulah"},{value:"gd",text:"Gaelic, Scottish Gaelic"},{value:"gl",text:"Galician"},{value:"lg",text:"Ganda"},{value:"ka",text:"Georgian"},{value:"de",text:"German"},{value:"ki",text:"Gikuyu, Kikuyu"},{value:"el",text:"Greek (Modern)"},{value:"kl",text:"Greenlandic, Kalaallisut"},{value:"gn",text:"Guarani"},{value:"gu",text:"Gujarati"},{value:"ht",text:"Haitian, Haitian Creole"},{value:"ha",text:"Hausa"},{value:"he",text:"Hebrew"},{value:"hz",text:"Herero"},{value:"hi",text:"Hindi"},{value:"ho",text:"Hiri Motu"},{value:"hu",text:"Hungarian"},{value:"is",text:"Icelandic"},{value:"io",text:"Ido"},{value:"ig",text:"Igbo"},{value:"id",text:"Indonesian"},{value:"ia",text:"Interlingua (International Auxiliary Language Association)"},{value:"ie",text:"Interlingue"},{value:"iu",text:"Inuktitut"},{value:"ik",text:"Inupiaq"},{value:"ga",text:"Irish"},{value:"it",text:"Italian"},{value:"ja",text:"Japanese"},{value:"jv",text:"Javanese"},{value:"kn",text:"Kannada"},{value:"kr",text:"Kanuri"},{value:"ks",text:"Kashmiri"},{value:"kk",text:"Kazakh"},{value:"rw",text:"Kinyarwanda"},{value:"kv",text:"Komi"},{value:"kg",text:"Kongo"},{value:"ko",text:"Korean"},{value:"kj",text:"Kwanyama, Kuanyama"},{value:"ku",text:"Kurdish"},{value:"ky",text:"Kyrgyz"},{value:"lo",text:"Lao"},{value:"la",text:"Latin"},{value:"lv",text:"Latvian"},{value:"lb",text:"Letzeburgesch, Luxembourgish"},{value:"li",text:"Limburgish, Limburgan, Limburger"},{value:"ln",text:"Lingala"},{value:"lt",text:"Lithuanian"},{value:"lu",text:"Luba-Katanga"},{value:"mk",text:"Macedonian"},{value:"mg",text:"Malagasy"},{value:"ms",text:"Malay"},{value:"ml",text:"Malayalam"},{value:"mt",text:"Maltese"},{value:"gv",text:"Manx"},{value:"mi",text:"Maori"},{value:"mr",text:"Marathi"},{value:"mh",text:"Marshallese"},{value:"ro",text:"Moldovan, Moldavian, Romanian"},{value:"mn",text:"Mongolian"},{value:"na",text:"Nauru"},{value:"nv",text:"Navajo, Navaho"},{value:"nd",text:"Northern Ndebele"},{value:"ng",text:"Ndonga"},{value:"ne",text:"Nepali"},{value:"se",text:"Northern Sami"},{value:"no",text:"Norwegian"},{value:"nb",text:"Norwegian Bokm\xe5l"},{value:"nn",text:"Norwegian Nynorsk"},{value:"ii",text:"Nuosu, Sichuan Yi"},{value:"oc",text:"Occitan (post 1500)"},{value:"oj",text:"Ojibwa"},{value:"or",text:"Oriya"},{value:"om",text:"Oromo"},{value:"os",text:"Ossetian, Ossetic"},{value:"pi",text:"Pali"},{value:"pa",text:"Panjabi, Punjabi"},{value:"ps",text:"Pashto, Pushto"},{value:"fa",text:"Persian"},{value:"pl",text:"Polish"},{value:"pt",text:"Portuguese"},{value:"qu",text:"Quechua"},{value:"rm",text:"Romansh"},{value:"rn",text:"Rundi"},{value:"ru",text:"Russian"},{value:"sm",text:"Samoan"},{value:"sg",text:"Sango"},{value:"sa",text:"Sanskrit"},{value:"sc",text:"Sardinian"},{value:"sr",text:"Serbian"},{value:"sn",text:"Shona"},{value:"sd",text:"Sindhi"},{value:"si",text:"Sinhala, Sinhalese"},{value:"sk",text:"Slovak"},{value:"sl",text:"Slovenian"},{value:"so",text:"Somali"},{value:"st",text:"Sotho, Southern"},{value:"nr",text:"South Ndebele"},{value:"es",text:"Spanish, Castilian"},{value:"su",text:"Sundanese"},{value:"sw",text:"Swahili"},{value:"ss",text:"Swati"},{value:"sv",text:"Swedish"},{value:"tl",text:"Tagalog"},{value:"ty",text:"Tahitian"},{value:"tg",text:"Tajik"},{value:"ta",text:"Tamil"},{value:"tt",text:"Tatar"},{value:"te",text:"Telugu"},{value:"th",text:"Thai"},{value:"bo",text:"Tibetan"},{value:"ti",text:"Tigrinya"},{value:"to",text:"Tonga (Tonga Islands)"},{value:"ts",text:"Tsonga"},{value:"tn",text:"Tswana"},{value:"tr",text:"Turkish"},{value:"tk",text:"Turkmen"},{value:"tw",text:"Twi"},{value:"ug",text:"Uighur, Uyghur"},{value:"uk",text:"Ukrainian"},{value:"ur",text:"Urdu"},{value:"uz",text:"Uzbek"},{value:"ve",text:"Venda"},{value:"vi",text:"Vietnamese"},{value:"vo",text:"Volap_k"},{value:"wa",text:"Walloon"},{value:"cy",text:"Welsh"},{value:"fy",text:"Western Frisian"},{value:"wo",text:"Wolof"},{value:"xh",text:"Xhosa"},{value:"yi",text:"Yiddish"},{value:"yo",text:"Yoruba"},{value:"za",text:"Zhuang, Chuang"},{value:"zu",text:"Zulu"}]},{name:"description",title:"Description",type:"multiline-text"}]},pi=function(e){var t=e.iface,a=e.onChange;return o.a.createElement(En.a,{noActions:!0,variant:"flat",onQuestionChange:function(e,n,o){n.value?a(Object(g.a)({},t,Object(E.a)({},e,n.value))):a(Object(g.a)({},t,Object(E.a)({},e,n)))},form:mi})},di={questions:[{name:"description",title:"Description",type:"multiline-text"},{name:"overlapAllowed",title:"Overlap Allowed",type:"boolean"},{name:"labels",title:"Labels",type:"matrixdynamic",hasOther:!0,columns:[{cellType:"text",name:"id",title:"ID"},{cellType:"text",name:"displayName",title:"Display Name"},{cellType:"text",name:"description",title:"Description"}]}]},fi=function(e){var t=e.iface,a=e.onChange,r=Object(n.useMemo)((function(){return{description:t.description,overlapAllowed:Boolean(t.overlapAllowed||void 0===t.overlapAllowed),labels:(t.labels||[]).map((function(e){return"string"===typeof e?{id:e,displayName:e,description:e}:e}))}}));return o.a.createElement(En.a,{noActions:!0,variant:"flat",onQuestionChange:function(e,n,o){a(Object(ko.setIn)(t,[e],n))},form:di,defaultAnswers:r})},gi=a(429),bi=a(345),vi=a(421),hi=a.n(vi),Oi=a(420),xi=a.n(Oi),Ei=Object(z.a)("div")({textAlign:"right"}),ki=Object(z.a)("div")({fontSize:18,color:M.a[500],fontWeight:"bold",textAlign:"center",padding:16}),ji=Object(z.a)("div")({position:"relative",padding:16,margin:16,borderLeft:"4px solid ".concat(m.a[400]),borderRadius:4,paddingRight:64,"& .quitButton":{position:"absolute",right:4,top:4},"& > *":{margin:8}}),yi=Object(z.a)("div")({fontSize:12,fontWeight:"bold",color:M.a[600],textTransform:"uppercase",margin:16,marginBottom:32}),wi=Object(z.a)(H.a)({position:"relative","& .icon":{marginRight:8,opacity:.7}}),Ci=function(e){var t=e.iface,a=e.onChange,r=Object(n.useRef)(),i=Object(n.useState)(!1),l=Object(O.a)(i,2),c=l[0],s=l[1],u=(t.surveyjs||{}).questions,m=void 0===u?[]:u;return o.a.createElement("div",null,0===m.length?o.a.createElement(ki,null,"No Inputs, Click Add Input Below"):m.map((function(e,n){return o.a.createElement(ji,{key:n},o.a.createElement("div",{style:{display:"flex"}},o.a.createElement(V.a,{variant:"outlined",label:"Name / Identifier",value:e.name||"",onChange:function(e){a(Object(ko.setIn)(t,["surveyjs","questions",n,"name"],e.target.value))}}),o.a.createElement(V.a,{style:{marginLeft:8,flexGrow:1},variant:"outlined",label:"Title / Instruction",value:e.title||"",onChange:function(e){a(Object(ko.setIn)(t,["surveyjs","questions",n,"title"],e.target.value))}})),o.a.createElement(Bt.a,{container:!0},o.a.createElement(Bt.a,{item:!0,xs:6},e.choices&&o.a.createElement(V.a,{style:{marginTop:8,paddingRight:8,boxSizing:"border-box"},variant:"outlined",fullWidth:!0,label:"Choices (One per Line)",defaultValue:e.choices.join("\n")||"",onChange:function(e){a(Object(ko.setIn)(t,["surveyjs","questions",n,"choices"],e.target.value.split("\n")))},multiline:!0,rows:6})),o.a.createElement(Bt.a,{item:!0,xs:6},o.a.createElement(yi,null,"Preview"),o.a.createElement(En.a,{noActions:!0,variant:"flat",key:e,form:{questions:[e]}}))),o.a.createElement(B.a,{className:"quitButton",onClick:function(){a(Object(ko.setIn)(t,["surveyjs","questions"],[].concat(Object(fa.a)(m.slice(0,n)),Object(fa.a)(m.slice(n+1)))))}},o.a.createElement(xi.a,null)))})),o.a.createElement(Ei,null,o.a.createElement(wi,{onClick:function(e){return s(!0)},ref:r},o.a.createElement(hi.a,{className:"icon"}),"Add Input")),o.a.createElement(gi.a,{anchorEl:r&&r.current,open:c,onClose:function(){return s(!1)}},o.a.createElement(bi.a,{onClick:function(){s(!1),a(Object(ko.setIn)(t,["surveyjs","questions"],t.surveyjs.questions.concat([{name:"input"+m.length,type:"text",title:"New Text Input"}])))}},"Text Input"),o.a.createElement(bi.a,{onClick:function(){s(!1),a(Object(ko.setIn)(t,["surveyjs","questions"],(t.surveyjs.questions||[]).concat({name:"input"+m.length,type:"radiogroup",title:"New Exclusive Choice Input",choices:["Yes","Maybe","No"]})))}},"Exclusive Choice"),o.a.createElement(bi.a,{onClick:function(){s(!1),a(Object(ko.setIn)(t,["surveyjs","questions"],(t.surveyjs.questions||[]).concat({name:"input"+m.length,type:"checkbox",title:"New Checkbox Input",choices:["A","B","C"]})))}},"Checkboxes"),o.a.createElement(bi.a,{onClick:function(){s(!1),a(Object(ko.setIn)(t,["surveyjs","questions"],t.surveyjs.questions.concat({name:"input"+m.length,type:"boolean",title:"New Boolean Input"})))}},"Boolean"),o.a.createElement(bi.a,{onClick:function(){s(!1),a(Object(ko.setIn)(t,["surveyjs","questions"],(t.questions||[]).concat({name:"input"+m.length,type:"dropdown",title:"New Dropdown Input",choices:["A","B","C"]})))}},"Dropdown / Autocomplete"),o.a.createElement(bi.a,{onClick:function(){s(!1),a(Object(ko.setIn)(t,["surveyjs","questions"],t.surveyjs.questions.concat([{name:"input"+m.length,type:"multiple-dropdown",title:"New Multiple Dropdown Input",choices:["A","B","C"]}])))}},"Multiple Item Dropdown / Autocomplete")))},Si=Object(z.a)("div")({}),Ii=Object(z.a)(lr.a)({marginTop:16,border:"2px solid #000"}),Di=Object(z.a)(H.a)({width:"100%",margin:16,marginLeft:0}),Ti=function(e){var t=e.iface,a=e.onChange;return o.a.createElement(o.a.Fragment,null,o.a.createElement(Si,null,(t.fields||[]).map((function(e,n){return o.a.createElement(Ii,{key:n},o.a.createElement(ur.a,{expandIcon:o.a.createElement(sr.a,null)},e.fieldName),o.a.createElement(mr.a,null,o.a.createElement(Pt.a,{display:"flex",flexDirection:"column"},o.a.createElement(V.a,{label:"Field Name",value:e.fieldName,onChange:function(e){a(Object(ko.setIn)(["fields",n,"fieldName"],e.target.value,t))}}),o.a.createElement(Mi,{iface:e.interface,onChange:function(n){a(Object(g.a)({},t,{fields:t.fields.map((function(t){return t.fieldName===e.fieldName?Object(g.a)({},e,{interface:n}):t}))}))}}),o.a.createElement(H.a,{onClick:function(){a(Object(g.a)({},t,{fields:t.fields.filter((function(t){return t.fieldName!==e.fieldName}))}))}},"Remove Field"))))})),o.a.createElement(Di,{onClick:function(){a(Object(ko.setIn)(t,["fields"],(t.fields||[]).concat({fieldOrder:(t.fields||[]).length,fieldName:"New Field",interface:{type:"empty"}})))}},"Add New Field")))},Ni=Object(z.a)("div")({textAlign:"center",paddingTop:30,paddingBottom:50,userSelect:"none"}),Ai=Object(z.a)("h3")({fontWeight:"bold",color:M.a[500]}),Li=Object(z.a)("a")({color:m.a[500]}),Ri=function(){return o.a.createElement(Ni,null,o.a.createElement(Ai,null,"Hey, this isn't currently available, but if you'd like this functionality please let us know by leaving a thumbs up on"," ",o.a.createElement(Li,{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/UniversalDataTool/universal-data-tool/issues/20"},"this")," ","github issue."))},Bi={questions:[{name:"regionTypesAllowed",title:"Region Types Allowed",description:"What types of regions can be drawn on the image.",type:"multiple-dropdown",choices:["bounding-box","polygon","point"]},{name:"multipleRegions",title:"Can multiple regions be created?",type:"boolean"},{name:"multipleRegionLabels",title:"Multiple Region Labels Allowed?",type:"boolean"},{name:"availableLabels",title:"Available Labels",description:"If you're labeling regions on an video frames, these are the allowed classifications or tags.",type:"matrixdynamic",columns:[{cellType:"text",name:"id",title:"id"},{cellType:"text",name:"description",title:"Description (optional)"}]}]},Pi=function(e){var t=e.iface,a=e.onChange,r=Object(n.useMemo)((function(){return{multipleRegions:Boolean(t.multipleRegions||void 0===t.multipleRegions),multipleRegionLabels:Boolean(t.multipleRegionLabels),regionTypesAllowed:t.regionTypesAllowed,availableLabels:(t.availableLabels||[]).map((function(e){return"string"===typeof e?{id:e,description:e}:e}))||[]}}),[]);return o.a.createElement(En.a,{noActions:!0,variant:"flat",defaultAnswers:r,onQuestionChange:function(e,n,o){a(Object(ko.setIn)(t,[e],n))},form:Bi})},_i=Object(z.a)("div")({fontSize:18,textAlign:"center",fontWeight:"bold",color:M.a[500],paddingTop:30,paddingBottom:50}),Ui=Object(z.a)(H.a)({margin:8,"& .icon":{marginRight:8,color:"#888"},alignItems:"center",justifyContent:"center","&.selected":{backgroundColor:m.a[500],color:"#fff","& .icon":{color:"#fff"}}}),Fi=Object(z.a)("div")({fontWeight:"bold",textTransform:"uppercase",fontSize:12,paddingLeft:8,marginBottom:8,marginTop:16,color:M.a[700]}),zi=function(e){var t=e.currentlySelected,a=e.onChange;return wt.map((function(e){return o.a.createElement(Ui,{key:e.oha.interface.type||"empty",className:t===e.oha.interface.type?"selected":"",variant:"outlined",onClick:function(){t!==e.oha.interface.type&&a(e.oha.interface.type)}},o.a.createElement(e.Icon,{className:"icon"}),e.name)}))},Mi=function(e){var t=e.iface,a=void 0===t?{}:t,n=e.onChange;e.onClickEditJSON;return o.a.createElement(ui,null,o.a.createElement(zi,{currentlySelected:a.type,onChange:function(e){n(Object(ko.setIn)(a,["type"],e))}}),o.a.createElement(Fi,null,"Options"),o.a.createElement(Pt.a,{paddingTop:2}),!a.type&&o.a.createElement(_i,null,"Select a Type"),"image_segmentation"===a.type&&o.a.createElement(ri,{iface:a,onChange:n}),"image_classification"===a.type&&o.a.createElement(li,{iface:a,onChange:n}),"composite"===a.type&&o.a.createElement(Ti,{iface:a,onChange:n}),"data_entry"===a.type&&o.a.createElement(Ci,{iface:a,onChange:n}),"audio_transcription"===a.type&&o.a.createElement(pi,{iface:a,onChange:n}),"text_entity_recognition"===a.type&&o.a.createElement(fi,{iface:a,onChange:n}),"text_classification"===a.type&&o.a.createElement(si,{iface:a,onChange:n}),"video_segmentation"===a.type&&o.a.createElement(Pi,{iface:a,onChange:n}),"3d_bounding_box"===a.type&&o.a.createElement(Ri,{iface:a,onChange:n}))},Wi=a(833),Hi=Object(z.a)(H.a)({margin:8}),Vi=function(e){var t=e.oha,a=e.onChange,n=e.onClickEditJSON,r=e.onClearLabelData,i=t.interface,l=ee(),c=Object(Wi.a)();ta();return o.a.createElement("div",null,o.a.createElement(Mi,{iface:i,onChange:a,onClickEditJSON:n}),o.a.createElement(ui,null,o.a.createElement(Fi,null,"Advanced"),o.a.createElement(Pt.a,{padding:2},o.a.createElement(Hi,{onClick:n,variant:"outlined"},"Edit JSON"),o.a.createElement(Hi,{onClick:function(){window.confirm("Are you sure you want to delete all your label data? Click OK to delete.")&&r()},variant:"outlined"},"Clear All Labels"),o.a.createElement(Hi,Object(E.a)({onClick:n,variant:"outlined"},"onClick",(function(){l.has_opted_out_capturing()?l.opt_in_capturing():l.opt_out_capturing(),c()})),l.has_opted_out_capturing()?"Enable":"Disable"," Telemetry"))))},qi=function(e){var t=e.open,a=e.sampleIndex,r=e.sampleInput,i=e.onChange,l=e.onClose,c=Object(n.useState)(),s=Object(O.a)(c,2),u=s[0],m=s[1],p=Object(n.useState)(),d=Object(O.a)(p,2),f=d[0],g=d[1];return Object(n.useEffect)((function(){var e=JSON.stringify(r,null,"  ");e!==u&&(m(e),g(null))}),[a]),o.a.createElement(Zt,{open:t,onClose:l,title:"taskData[".concat(a,"]")},o.a.createElement(ba.a,{theme:"github",mode:"javascript",width:"100%",value:u,editorProps:{$blockScrolling:1/0},onChange:function(e){m(e),g(null);try{i(JSON.parse(e))}catch(t){g(t.toString())}}}),o.a.createElement(Pt.a,{color:"red"},f))},Ji=Object(z.a)("div")({}),Gi=Object(z.a)("div")({display:"inline-flex",flexDirection:"column",margin:16}),Ki=Object(z.a)("div")({fontSize:14,fontWeight:"bold",color:M.a[700]}),Yi=Object(z.a)("div")({fontSize:32,marginTop:8}),Qi=function(e){var t=e.stats;return o.a.createElement(Ji,null,t.map((function(e){return o.a.createElement(Gi,{key:e.name},o.a.createElement(Ki,null,e.name),o.a.createElement(Yi,null,e.value))})))},Xi=(a(82),a(283)),Zi=a.n(Xi),$i=a(824),el=a(435),tl=Object(l.a)({root:{position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,alignItems:"flex-start",pointerEvents:"none"},msgBox:{display:"flex",backgroundColor:m.a[700],fontSize:12,color:"#fff",padding:4,marginBottom:4,boxShadow:"0px 3px 8px rgba(0,0,0,0.5)","&.warning":{backgroundColor:Se.a[700]},"&.error":{backgroundColor:W.a[700]}}}),al=Object(n.createContext)(),nl=function(){return{addToast:Object(n.useContext)(al).addToast}},ol=function(e){var t=e.children,a=Object(n.useReducer)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if("add"===t.type){var a="info"===t.messageType?2e3:(t.messageType,5e3);return e.concat([{id:Math.random().toString().split(".")[1],message:t.message,type:t.messageType,life:a,fullLife:a}])}return"tick"===t.type?e.map((function(e){return Object(g.a)({},e,{life:e.life-100})})).filter((function(e){return e.life>0})):e}),[]),r=Object(O.a)(a,2),i=r[0],l=r[1],c=tl();Object(n.useEffect)((function(){if(0===i.length)return function(){};var e=setInterval((function(){l({type:"tick"})}),100);return function(){return clearInterval(e)}}),[i]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(al.Provider,{value:{toasts:i,addToast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";return l({type:"add",message:e,messageType:t})}}},t),o.a.createElement("div",{className:c.root},i.map((function(e){return o.a.createElement($i.a,{key:e.id,in:e.life<e.fullLife},o.a.createElement(el.a,{in:e.life>600},o.a.createElement("div",{className:Vn()(c.msgBox,e.type)},e.message)))}))))},rl=(a(743),a(745),Object(l.a)({headerButton:{color:"#fff"},saveIcon:{marginRight:4},editIcon:{marginLeft:4},container:{display:"flex",flexDirection:"column",width:"100vw",height:"100vh"}})),il=["Settings","Samples","Label"],ll=function(e){e.datasetName;var t=e.oha,a=(e.content,e.inSession),r=e.url,i=e.fileName,l=void 0===i?"unnamed":i,c=e.onChangeFileName,s=e.onChangeOHA,u=void 0===s?function(){return null}:s,m=(e.onFileDrop,e.initialMode),p=void 0===m?"settings":m,d=e.selectedBrush,f=void 0===d?"complete":d,b=rl(),v=nl().addToast,h=Object(n.useState)(p),x=Object(O.a)(h,2),E=x[0],k=x[1],j=Object(n.useState)(),y=Object(O.a)(j,2),w=y[0],C=y[1],S=Object(n.useState)({}),I=Object(O.a)(S,2),D=I[0],T=I[1],N=Object(n.useState)(),A=Object(O.a)(N,2),L=A[0],R=A[1],B=$()||{},P=(B.remote,B.ipcRenderer),_=function(){var e=Object(n.useReducer)((function(e,t){var a=e.samplesInWindow.slice(-10).concat([t]);return{timeToCompleteSample:a.reduce((function(e,t){return e+t}),0)/a.length,samplesInWindow:a}}),{timeToCompleteSample:0,samplesInWindow:[]}),t=Object(O.a)(e,2);return[t[0].timeToCompleteSample,t[1]]}(),U=Object(O.a)(_,2),F=U[0],z=U[1];Object(n.useEffect)((function(){if(P){var e=function(){return k("settings")},t=function(){return k("samples")},a=function(){return k("label")};return P.on("open-settings-page",e),P.on("open-samples-page",t),P.on("open-label-page",a),function(){P.removeListener("open-settings-page",e),P.removeListener("open-samples-page",t),P.removeListener("open-label-page",a)}}}),[]),Object(n.useEffect)((function(){"json"===E&&R(JSON.stringify(t,null,"  "))}),[E]),Object(n.useEffect)((function(){if(L&&"json"===E)try{u(JSON.parse(L))}catch(e){}}),[L]);var M=Object(De.a)((function(e){return k(e.toLowerCase())})),W=0;return t.taskOutput&&t.taskOutput.length>0&&t.taskData&&t.taskData.length>0&&(W=t.taskOutput.filter(Boolean).length/t.taskData.length),o.a.createElement("div",{className:b.container},o.a.createElement(Rt,{title:a?o.a.createElement(V.a,{label:"Share Link",value:r,variant:"outlined",size:"small"}):o.a.createElement(Un,{label:"File Name",onChange:c,value:l||""}),onChangeTab:M,currentTab:E,tabs:il}),o.a.createElement("div",{style:{overflowY:"scroll"}},"json"===E&&o.a.createElement(ba.a,{theme:"github",mode:"javascript",width:"100%",value:L||"",editorProps:{$blockScrolling:1/0},onChange:function(e){return R(e)}}),"settings"===E&&o.a.createElement(Vi,{onClickEditJSON:function(){return k("json")},oha:t,onClearLabelData:function(){u(Object(ko.without)(t,"taskOutput"))},onChange:function(e){e.type!==t.interface.type&&"empty"!==t.interface.type&&t.taskOutput&&t.taskOutput.some(Boolean)&&v("Warning: Changing label types can cause label data issues. You might want to clear all label data.","error"),u(Object(g.a)({},t,{interface:e}))}}),"samples"===E&&o.a.createElement(ni,{oha:t,openSampleLabelEditor:function(e){C(Object(g.a)({},t,{taskData:[t.taskData[e]],taskOutput:[(t.taskOutput||[])[e]],sampleIndex:e,annotationStartTime:Date.now()})),k("label")},openSampleInputEditor:function(e){T({open:!0,sampleIndex:e})},deleteSample:function(e){var a=Object(fa.a)(t.taskData),n=t.taskOutput?Object(fa.a)(t.taskOutput):void 0;a.splice(e,1),n&&n.splice(e,1),u(Object(g.a)({},t,{taskData:a,taskOutput:n}))},onChangeOHA:u}),"label"===E&&w?o.a.createElement(Pn,{datasetName:"Sample ".concat(w.sampleIndex),onSaveTaskOutputItem:function(e,a){var n=t;n.taskOutput||(n=Object(ko.setIn)(n,["taskOutput"],(n.taskData||[]).map((function(e){return null})))),(n.taskOutput.length<n.taskData.length||n.taskOutput.includes(void 0))&&(n=Object(ko.setIn)(n,["taskOutput"],n.taskData.map((function(e,t){return void 0===n.taskOutput[t]?null:n.taskOutput[t]})))),n=Object(ko.setIn)(n,["taskOutput",w.sampleIndex],a),w.taskData[0].brush===f||void 0===w.taskData[0].brush&&"complete"===f||(n=Object(ko.setIn)(n,["taskData",w.sampleIndex,"brush"],f)),C(Object(ko.setIn)(w,["taskOutput",e],a)),u(n)},onExit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"nothing";w.startTime&&z(Date.now()-w.startTime);var a=w.sampleIndex;switch(e){case"go-to-next":if(a!==t.taskData.length-1)return void C(Object(g.a)({},t,{taskData:[t.taskData[a+1]],taskOutput:[(t.taskOutput||[])[a+1]],sampleIndex:a+1,startTime:Date.now()}));break;case"go-to-previous":if(0!==a)return void C(Object(g.a)({},t,{taskData:[t.taskData[a-1]],taskOutput:[(t.taskOutput||[])[a-1]],sampleIndex:a-1,startTime:Date.now()}))}C(null)},oha:w}):"label"===E&&o.a.createElement(ui,null,o.a.createElement(Qi,{stats:[{name:"Percent Complete",value:Math.floor(100*W)+"%"},{name:"Time per Sample",value:Zi()(new Date(Date.now()-F)).toString(1,1)},{name:"Estimated Remaining",value:Zi()(new Date(Date.now()-F*(1-W)*(t.taskData||[]).length)).toString(1,2)}]}),o.a.createElement(Yn,{count:(t.taskData||[]).length,taskData:t.taskData||[],completed:(t.taskOutput||[]).map(Boolean),onClick:function(e){C(Object(g.a)({},t,{taskData:[t.taskData[e]],taskOutput:[(t.taskOutput||[])[e]],sampleIndex:e,startTime:Date.now()}))}}))),o.a.createElement(qi,Object.assign({},D,{sampleInput:void 0!==D.sampleIndex?t.taskData[D.sampleIndex]:null,onClose:function(){T({open:!1})},onChange:function(e){u(Object(ko.setIn)(t,["taskData",D.sampleIndex],e))}})))},cl=Object(l.a)({root:{position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,alignItems:"center",pointerEvents:"none"},errorBox:{display:"flex",backgroundColor:W.a[700],color:"#fff",padding:4,marginBottom:4}}),sl=function(e){var t=e.errors,a=cl();return o.a.createElement("div",{className:a.root},t.map((function(e){return o.a.createElement($i.a,{key:e.id,in:e.life<5e3},o.a.createElement(el.a,{in:e.life>500},o.a.createElement("div",{className:a.errorBox},e.message)))})))},ul=function(){var e=Object(n.useState)([]),t=Object(O.a)(e,2),a=t[0],o=t[1];return Object(n.useEffect)((function(){if(0===a.length)return function(){};var e=setInterval((function(){o(a.map((function(e){return Object(g.a)({},e,{life:e.life-100})})).filter((function(e){return e.life>0})))}),100);return function(){return clearInterval(e)}}),[a]),[a,function(e){o(a.concat([{id:Math.random().toString().split(".")[1],message:e,life:5e3}]))}]},ml=a(228),pl=a.n(ml),dl=a(422),fl=a(423),gl=a.n(fl),bl=a(163),vl=a.n(bl);function hl(e,t){return e.concat([t])}function Ol(e,t){if(0===t.length)return Object(ko.without)(e,t[0]);var a=t.slice(0,-1),n=t[t.length-1],o=Object(ko.getIn)(e,a);if(Array.isArray(o)){var r=parseInt(n);return Object(ko.setIn)(e,a,[].concat(Object(fa.a)(o.slice(0,r)),Object(fa.a)(o.slice(r+1))))}return Object(ko.setIn)(e,a,Object(ko.without)(o,n))}var xl=function(e,t){var a,n=Object(Ra.a)(t);try{for(n.s();!(a=n.n()).done;){var o=a.value,r=o.op,i=o.path;if(0===(i=i.split("/").filter(Boolean)).length){if("replace"===r){e=o.value;continue}throw new Error("Operation on root object not supported")}switch(r){case"replace":e=Object(ko.setIn)(e,i,o.value);continue;case"copy":e=Object(ko.setIn)(e,i,Object(ko.getIn)(e,o.from.split("/")));continue;case"add":if(isNaN(parseInt(i.slice(-1)[0])))e=Array.isArray(Object(ko.getIn)(e,i))?Object(ko.updateIn)(e,i,hl,o.value):Object(ko.setIn)(e,i,o.value);else e=Object(ko.setIn)(e,i,o.value);continue;case"move":var l=o.from.split("/");e=Ol(e=Object(ko.setIn)(e,i,Object(ko.getIn)(e,l)),l);continue;case"remove":e=Ol(e,i);continue}}}catch(ec){n.e(ec)}finally{n.f()}return e},El=window.localStorage.useLocalCollaborationServer?"http://localhost:3000":"https://udt-collaboration.workaround.now.sh",kl=pl()("json","GET",El),jl=pl()("json","POST",El),yl=pl()("json","PATCH",El),wl=function(e){return gl()(JSON.parse(JSON.stringify(e)))},Cl=function(){var e=Object(h.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,kl("/api/session/".concat(encodeURIComponent(t)));case 3:return a=e.sent,e.abrupt("return",{state:a.udt_json,version:a.version});case 7:return e.prev=7,e.t0=e.catch(0),console.log('error getting session "'.concat(t,'"')),e.abrupt("return",{state:null,version:null});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),Sl=function(){var e=Object(h.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jl("/api/session",{udt:t.content});case 2:return a=e.sent,e.abrupt("return",{id:a.short_id,sessionId:a.short_id,url:"".concat(window.location.origin,"?s=").concat(a.short_id),content:t.content,lastSyncedVersion:a.version,lastSyncedState:vl()(t.content),mode:"server"});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Il=a(273),Dl=function(e){var t={};t.interface=e.interface,t.samples=e.taskData.map((function(t,a){return Object(g.a)({},t,{output:(e.taskOutput||[])[a]})}));var a,n=new Set,o=Object(Ra.a)(t.samples);try{for(o.s();!(a=o.n()).done;){var r=a.value;Object.keys(Object(Il.flatten)(r)).forEach((function(e){return n.add(e)}))}}catch(ec){o.e(ec)}finally{o.f()}(n=Array.from(n).sort((function(e,t){return e.split(".").length-t.split(".").length}))).some((function(e){return e.includes("output.keyframes")}))&&(n=n.filter((function(e){return e.includes("output.keyframes")}))).push("output.keyframes");var i={rows:["interface"].concat(Object(fa.a)(Da()(t.samples.length).map((function(e){return"samples.".concat(e)})))),columns:["."].concat(Object(fa.a)(n))};return Do.a.toCSV(t,i)},Tl={saveFile:function(){return null}},Nl=ee(),Al=function(){var e,t=Object(n.useState)(),a=Object(O.a)(t,2),o=a[0],r=a[1],i=nl().addToast,l=function(e,t){if(!ta())return Tl;var a=nl().addToast,o=$(),r=o.remote,i=(o.ipcRenderer,Object(De.a)((function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.saveAs,i=void 0!==o&&o;function l(){return c.apply(this,arguments)}function c(){return(c=Object(h.a)(v.a.mark((function n(){var o,l,c,s;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.filePath,e.filePath&&!i){n.next=12;break}return n.next=4,r.dialog.showSaveDialog({filters:[{name:".udt.json",extensions:["udt.json"]},{name:".udt.csv",extensions:["udt.csv"]}]});case 4:if(l=n.sent,c=l.cancelled,s=l.filePath,o=!s||s.endsWith(".json")||s.endsWith(".csv")?s:"".concat(s,".udt.json"),!c&&o){n.next=11;break}return a("Could not save"),n.abrupt("return");case 11:t(Object(g.a)({},e,{filePath:o,fileName:o.split("/").slice(-1)[0]}));case 12:return n.next=14,r.require("fs").promises.writeFile(o,o.endsWith(".csv")?Dl(e.content):JSON.stringify(e.content,null,"  "));case 14:a("File Saved!");case 15:case"end":return n.stop()}}),n)})))).apply(this,arguments)}e&&l()})));return Object(n.useEffect)((function(){e&&e.filePath&&e.fileName!==e.filePath.split("/").slice(-1)[0]&&t(Object(ko.setIn)(e,["filePath"],e.filePath.split("/").slice(0,-1).concat([e.fileName+(e.fileName.endsWith(".json")?"":".oha.json")]).join("/")))}),[e&&e.fileName,e&&e.fileName]),{saveFile:i}}(o,r).saveFile,c=function(e,t){var a=Object(R.a)("recentItems",[]),o=Object(O.a)(a,2),r=o[0],i=o[1];return r||(r=[]),Object(n.useEffect)((function(){e&&e.fileName&&"unnamed"!==e.fileName&&("local-storage"!==e.mode&&"filesystem"!==e.mode||(r.map((function(e){return e.id})).includes(e.id)?i(r.map((function(t){return t.id===e.id?e:t}))):i([e].concat(r).slice(0,3))))}),[e]),{recentItems:r,changeRecentItems:i}}(o),s=c.recentItems,u=c.changeRecentItems;!function(e,t){var a=nl().addToast;Object(n.useEffect)((function(){if(e&&"server"===e.mode){var n=function(){var r=Object(h.a)(v.a.mark((function r(){var i,l,c,s,u,m,p,d,f,b,h,O,x,E,k,j;return v.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=4,kl("/api/session/".concat(encodeURIComponent(e.sessionId),"/diffs?since=").concat(e.lastSyncedVersion));case 4:u=r.sent,i=u.patch,l=u.hashOfLatestState,c=u.latestVersion,s=u.changeLog,r.next=15;break;case 11:return r.prev=11,r.t0=r.catch(0),a("There was an issue connecting to the server. Refresh to retry.","error"),r.abrupt("return");case 15:if(o){r.next=17;break}return r.abrupt("return");case 17:m=Object(Ra.a)(s);try{for(m.s();!(p=m.n()).done;)d=p.value,f=d.userName,b=d.op,(h=d.path).startsWith("/interface")?a("".concat(f," changed the project settings"),"warning"):h.startsWith("/taskOutput")?(O=h.match(/\/taskOutput\/([^\/]+)/))?a("".concat(f," labeled sample ").concat(O[1])):a("".concat(f," changed many samples"),"warning"):h.startsWith("/taskData")?a("".concat(f," changed the sample data"),"warning"):a("".concat(f," did a ").concat(b," at ").concat(h))}catch(ec){m.e(ec)}finally{m.f()}if(!(i.length>0)){r.next=33;break}if(!1,x=xl(e.content,i),wl(x)===l){r.next=32;break}return console.log("when getting diffs, hashes were not equal! getting latest version from server..."),r.next=26,Cl(e.sessionId);case 26:E=r.sent,k=E.state,j=E.version,t(jo()(Object(g.a)({},e,{content:k,lastSyncedState:k,lastSyncedVersion:j}))),r.next=33;break;case 32:t(jo()(Object(g.a)({},e,{content:x,lastSyncedState:x,lastSyncedVersion:c})));case 33:if(o){r.next=35;break}return r.abrupt("return");case 35:o=setTimeout(n,500);case 36:case"end":return r.stop()}}),r,null,[[0,11]])})));return function(){return r.apply(this,arguments)}}(),o=setTimeout(n,500);return function(){clearTimeout(o),o=null}}}),[e]),Object(n.useEffect)((function(){function a(){return(a=Object(h.a)(v.a.mark((function a(){var n,o,r,i,l,c,s,u;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==(n=dl.createPatch(e.lastSyncedState,e.content)).length){a.next=3;break}return a.abrupt("return");case 3:o="anonymous";try{o=JSON.parse(window.localStorage.userName)}catch(m){}return a.next=7,yl("/api/session/".concat(encodeURIComponent(e.sessionId)),{patch:n,userName:o});case 7:if(r=a.sent,i=r.hashOfLatestState,l=r.latestVersion,wl(e.content)===i){a.next=20;break}return console.log("after patch, hashes were not equal! getting latest version from server..."),a.next=14,Cl(e.sessionId);case 14:c=a.sent,s=c.state,u=c.version,t(jo()(Object(g.a)({},e,{content:s,lastSyncedState:s,lastSyncedVersion:u}))),a.next=21;break;case 20:t(Object(ko.setIn)(Object(ko.setIn)(e,["lastSyncedVersion"],l),["lastSyncedState"],e.content));case 21:case"end":return a.stop()}}),a)})))).apply(this,arguments)}e&&"server"===e.mode&&function(){a.apply(this,arguments)}()}),[e&&e.content])}(o,r),e=o&&o.content,Object(n.useEffect)((function(){e&&e.interface&&(Nl.capture("interface_type",{interface_type:e.interface.type}),Nl.people.set({last_used_interface_type:e.interface.type}))}),[e&&e.interface&&e.interface.type]),Object(n.useEffect)((function(){e&&e.taskData&&Nl.capture("dataset_size",{dataset_size:(e.taskData||[]).length})}),[e&&(e.taskData||[]).length]),Object(n.useEffect)((function(){if(e&&e.taskOutput){var t=e.taskOutput.filter(Boolean).length;Nl.capture("sample_completion",{dataset_size:(e.taskData||[]).length,samples_completed:t,percent_completed:t/(e.taskData||[]).length})}}),[e&&(e.taskData||[]).length,e&&e.taskOutput&&e.taskOutput.filter(Boolean).length]);var m=Object(De.a)((function(e){var t=e.name,a=e.path;function n(e){try{var n;n=t.endsWith("csv")?zo(e):JSON.parse(e),r({fileName:t,filePath:a,mode:a?"filesystem":"local-storage",content:n,id:a})}catch(o){console.log(o.toString()),i("Couldn't read file, see console for details","error")}}if(e.content)n(e.content);else{var o=new FileReader;o.onload=function(e){n(e.target.result)},o.readAsText(e)}})),p=Object(De.a)(function(){var e=Object(h.a)(v.a.mark((function e(t){var a,n,o,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=decodeURIComponent(t.match(/[\?&]s=([^&]+)/)[1])){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Cl(a);case 5:if(n=e.sent,o=n.state,i=n.version,o){e.next=10;break}return e.abrupt("return");case 10:window.history.replaceState({},window.document.title,"/?s=".concat(encodeURIComponent(a))),r({url:t,sessionId:a,mode:"server",id:a,content:o,lastSyncedState:vl()(o),lastSyncedVersion:i});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());Object(n.useEffect)((function(){o&&"server"!==o.mode&&window.history.replaceState({},window.document.title,"/")}),[o&&o.mode]),Object(n.useEffect)((function(){window.location.search.match(/[\?&]s=([a-zA-Z0-9]+)/)&&p(window.location.href)}),[]);var d=Object(De.a)(Object(h.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sl(o);case 2:t=e.sent,r(t),window.history.replaceState({},window.document.title,"/?s=".concat(encodeURIComponent(t.sessionId)));case 5:case"end":return e.stop()}}),e)}))));return Object(n.useMemo)((function(){return{file:o,changeFile:r,openFile:m,openUrl:p,makeSession:d,saveFile:l,recentItems:s,changeRecentItems:u}}),[o,r,m,d,s])},Ll=a(284),Rl=a.n(Ll),Bl=a(219),Pl=a(424),_l=a(431),Ul=a(428),Fl=a(427),zl=a(426),Ml=a.n(zl),Wl=a(834),Hl=a(55);Wl.a({dsn:"https://bc19fbac222243f08f0abaf6d66f2034@sentry.io/5182632"});var Vl=Object(z.a)("div")({width:"100vw",minHeight:"100vh",backgroundColor:M.a[900],padding:32,"& .title":{color:M.a[200],fontSize:24,fontWeight:"bold"},"& .subtitle":{color:M.a[300],fontSize:18,marginTop:8},"& .info":{width:"100%",boxSizing:"border-box",padding:32,"& textarea":{width:"calc(100% - 64px)",boxSizing:"border-box",minHeight:300,fontSize:12}}}),ql=Object(z.a)("div")({padding:8}),Jl=Object(z.a)(H.a)({color:"#fff",borderColor:"rgba(255,255,255,0.5)",margin:8}),Gl=function(e){Object(_l.a)(a,e);var t=Object(Ul.a)(a);function a(e){var n;return Object(Bl.a)(this,a),(n=t.call(this,e)).state={hasError:!1},n}return Object(Pl.a)(a,[{key:"componentDidCatch",value:function(e,t){var a=this;Hl.b((function(n){n.setExtras(t);var o=Hl.a(e);a.setState({eventId:o})}))}},{key:"render",value:function(){return this.state.hasError?o.a.createElement(Vl,null,o.a.createElement("div",{className:"title"},"Something has gone amiss"),o.a.createElement("div",{className:"subtitle"},"All the details are below:"),o.a.createElement("div",{className:"info"},o.a.createElement("textarea",null,this.state.errorDetails)),o.a.createElement(ql,null,o.a.createElement(Jl,{variant:"outlined",target:"_blank",href:"https://github.com/Universal/universal-data-tool/issues"},o.a.createElement(Ml.a,{style:{color:"#fff",marginRight:8}})," View Issues on Github"),o.a.createElement(Jl,{variant:"outlined",onClick:function(){return window.location.reload()}},"Reload (unsaved progress will be lost)"))):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,errorDetails:JSON.stringify(Object(Fl.a)())+"\n\n"+e.stack}}}]),a}(o.a.Component),Kl=Object(l.a)({empty:{textAlign:"center",padding:100,color:"#666",fontSize:28}}),Yl=function(){return Math.random().toString().split(".")[1]},Ql=function(){Kl();var e=Al(),t=e.file,a=e.changeFile,r=e.openFile,i=e.openUrl,l=e.makeSession,c=e.recentItems,s=e.changeRecentItems,u=ul(),m=Object(O.a)(u,2),p=m[0],d=(m[1],Object(n.useState)("complete")),f=Object(O.a)(d,2),b=f[0],x=f[1],E=Object(De.a)((function(e){a({fileName:"unnamed",content:e.oha,id:Yl(),mode:"local-storage"})})),k=Object(De.a)((function(e){return a(e)})),j=Object(De.a)((function(){return a(null)})),y=Object(De.a)((function(e){if(t){var a=(t.sessionId||t.fileName)+".udt."+e;"json"===e?Rl()(JSON.stringify(t.content),a):"csv"===e&&Rl()(Dl(t.content),a)}})),w=t&&"server"===t.mode,C=Object(n.useState)(!1),S=Object(O.a)(C,2),I=S[0],D=S[1],T=Object(n.useCallback)(function(){var e=Object(h.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),N=Object(De.a)((function(){return a(Object(g.a)({},t,{mode:"local-storage",id:Yl(),fileName:"unnamed"}))}));return o.a.createElement(o.a.Fragment,null,o.a.createElement(At.Provider,{value:{title:t?"local-storage"===t.mode?t.fileName:t.url:"unnamed",recentItems:c,changeRecentItems:s,onClickTemplate:E,onClickHome:j,onOpenFile:r,onOpenRecentItem:k,inSession:w,sessionBoxOpen:I,changeSessionBoxOpen:D,onJoinSession:T,onLeaveSession:N,onCreateSession:l,fileOpen:Boolean(t),onDownload:y,onChangeSelectedBrush:x,selectedBrush:b}},t?o.a.createElement(Gl,null,o.a.createElement(ll,Object.assign({key:t.id},t,{selectedBrush:b,inSession:w,oha:t.content,onChangeFileName:function(e){a(Object(ko.setIn)(t,["fileName"],e))},onChangeOHA:function(e){a(Object(ko.setIn)(t,["content"],e))}}))):o.a.createElement(da,{onFileDrop:r,onOpenTemplate:E,recentItems:c,onOpenRecentItem:k,onClickOpenSession:function(){return D(!0)}})),o.a.createElement(sl,{errors:p}))},Xl=Object(l.a)({empty:{textAlign:"center",padding:100,color:"#666",fontSize:28}}),Zl=function(){Xl();var e=Al(),t=e.file,a=e.changeFile,r=e.openFile,i=(e.openUrl,e.makeSession,e.saveFile),l=e.recentItems,c=Object(n.useState)("complete"),s=Object(O.a)(c,2),u=s[0],m=s[1],p=ul(),d=Object(O.a)(p,2),f=d[0],g=(d[1],nl().addToast,$()),b=g.remote,x=g.ipcRenderer,E=Object(De.a)((function(e){a({fileName:"unnamed",content:e.oha,id:Math.random().toString().split(".")[1],mode:"filesystem"})})),k=Object(De.a)((function(e){return a(e)})),j=Object(De.a)((function(){return a(null)}));return Object(n.useEffect)((function(){var e=function(){return a(null)},n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.templateName;E(wt.find((function(e){return e.name===a}))||wt[0])},o=function(){return i({saveAs:!0})},l=function(){var e=Object(h.a)(v.a.mark((function e(){var a,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,b.dialog.showSaveDialog({filters:[{name:".udt.csv",extensions:["udt.csv"]}]});case 4:return a=e.sent,a.cancelled,n=!(n=a.filePath)||n.endsWith(".csv")?n:"".concat(n,".udt.csv"),e.next=10,b.require("fs").promises.writeFile(n,Dl(t.content));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(e,t){return console.log(t),r(t)};return x.on("open-welcome-page",e),x.on("new-file",n),x.on("open-file",c),x.on("save-file",i),x.on("save-file-as",o),x.on("export-to-csv",l),function(){x.removeListener("open-welcome-page",e),x.removeListener("new-file",n),x.removeListener("open-file",c),x.removeListener("save-file",i),x.removeListener("save-file-as",o),x.removeListener("export-to-csv",l)}}),[t]),o.a.createElement(o.a.Fragment,null,o.a.createElement(At.Provider,{value:{recentItems:l,onClickTemplate:E,onClickHome:j,title:t?t.fileName:null,fileOpen:Boolean(t),onOpenRecentItem:k,isDesktop:!0,onOpenFile:r,selectedBrush:u,onChangeSelectedBrush:m}},t?o.a.createElement(ll,Object.assign({key:t.id},t,{selectedBrush:u,oha:t.content,onChangeFileName:function(e){a(Object(ko.setIn)(t,["fileName"],e))},onChangeOHA:function(e){a(Object(ko.setIn)(t,["content"],e))}})):o.a.createElement(da,{showDownloadLink:!1,onFileDrop:r,onOpenTemplate:E,recentItems:l,onOpenRecentItem:k})),o.a.createElement(sl,{errors:f}))},$l=function(){var e=$();return o.a.createElement(f,null,o.a.createElement(ol,null,Boolean(e)?o.a.createElement(Zl,null):o.a.createElement(Ql,null)))};i.a.render(o.a.createElement($l,null),document.getElementById("root"))}},[[452,1,2]]]);
//# sourceMappingURL=main.9de52866.chunk.js.map